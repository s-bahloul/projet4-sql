!function(e){var t;if("function"==typeof define&&define.amd&&(define(e),t=!0),"object"==typeof exports&&(module.exports=e(),t=!0),!t){var r=window.Cookies,n=window.Cookies=e();n.noConflict=function(){return window.Cookies=r,n}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var r=arguments[e];for(var n in r)t[n]=r[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function r(n){function i(){}function o(t,r,o){if("undefined"!=typeof document){o=e({path:"/"},i.defaults,o),"number"==typeof o.expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var a=JSON.stringify(r);/^[\{\[]/.test(a)&&(r=a)}catch(s){}r=n.write?n.write(r,t):encodeURIComponent(String(r)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var l="";for(var c in o)o[c]&&(l+="; "+c,o[c]!==!0&&(l+="="+o[c].split(";")[0]));return document.cookie=t+"="+r+l}}function a(e,r){if("undefined"!=typeof document){for(var i={},o=document.cookie?document.cookie.split("; "):[],a=0;a<o.length;a++){var s=o[a].split("="),l=s.slice(1).join("=");r||'"'!==l.charAt(0)||(l=l.slice(1,-1));try{var c=t(s[0]);if(l=(n.read||n)(l,c)||t(l),r)try{l=JSON.parse(l)}catch(u){}if(i[c]=l,e===c)break}catch(u){}}return e?i[e]:i}}return i.set=o,i.get=function(e){return a(e,!1)},i.getJSON=function(e){return a(e,!0)},i.remove=function(t,r){o(t,"",e(r,{expires:-1}))},i.defaults={},i.withConverter=r,i}return r(function(){})}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("underscore",t):(e=e||self,function(){var r=e._,n=e._=t();n.noConflict=function(){return e._=r,n}}())}(this,function(){function e(e,t){return t=null==t?e.length-1:+t,function(){for(var r=Math.max(arguments.length-t,0),n=Array(r),i=0;i<r;i++)n[i]=arguments[i+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var o=Array(t+1);for(i=0;i<t;i++)o[i]=arguments[i];return o[t]=n,e.apply(this,o)}}function t(e){var t=typeof e;return"function"===t||"object"===t&&!!e}function r(e){return null===e}function n(e){return void 0===e}function i(e){return e===!0||e===!1||"[object Boolean]"===rt.call(e)}function o(e){return!(!e||1!==e.nodeType)}function a(e){return function(t){return rt.call(t)==="[object "+e+"]"}}function s(e,t){return null!=e&&nt.call(e,t)}function l(e){return!yt(e)&&ut(e)&&!isNaN(parseFloat(e))}function c(e){return gt(e)&&ct(e)}function u(e){return function(){return e}}function d(e){return function(t){var r=e(t);return"number"==typeof r&&r>=0&&r<=pt}}function f(e){return function(t){return null==t?void 0:t[e]}}function p(e){return lt?lt(e)&&!Ut(e):Rt(e)&&jt.test(rt.call(e))}function b(e){for(var t={},r=e.length,n=0;n<r;++n)t[e[n]]=!0;return{contains:function(e){return t[e]},push:function(r){return t[r]=!0,e.push(r)}}}function g(e,t){t=b(t);var r=ft.length,n=e.constructor,i=At(n)&&n.prototype||Xe,o="constructor";for(s(e,o)&&!t.contains(o)&&t.push(o);r--;)o=ft[r],o in e&&e[o]!==i[o]&&!t.contains(o)&&t.push(o)}function v(e){if(!t(e))return[];if(at)return at(e);var r=[];for(var n in e)s(e,n)&&r.push(n);return dt&&g(e,r),r}function h(e){return null==e||(Ft(e)&&(St(e)||bt(e)||xt(e))?0===e.length:0===v(e).length)}function m(e,t){var r=v(t),n=r.length;if(null==e)return!n;for(var i=Object(e),o=0;o<n;o++){var a=r[o];if(t[a]!==i[a]||!(a in i))return!1}return!0}function y(e){return e instanceof y?e:this instanceof y?void(this._wrapped=e):new y(e)}function w(e,t,r,n){if(e===t)return 0!==e||1/e===1/t;if(null==e||null==t)return!1;if(e!==e)return t!==t;var i=typeof e;return("function"===i||"object"===i||"object"==typeof t)&&E(e,t,r,n)}function E(e,t,r,n){e instanceof y&&(e=e._wrapped),t instanceof y&&(t=t._wrapped);var i=rt.call(e);if(i!==rt.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!==+e?+t!==+t:0===+e?1/+e===1/t:+e===+t;case"[object Date]":case"[object Boolean]":return+e===+t;case"[object Symbol]":return Ze.valueOf.call(e)===Ze.valueOf.call(t);case"[object ArrayBuffer]":return E(new DataView(e),new DataView(t),r,n);case"[object DataView]":var o=Tt(e);if(o!==Tt(t))return!1;for(;o--;)if(e.getUint8(o)!==t.getUint8(o))return!1;return!0}if(Pt(e))return E(new DataView(e.buffer),new DataView(t.buffer),r,n);var a="[object Array]"===i;if(!a){if("object"!=typeof e||"object"!=typeof t)return!1;var l=e.constructor,c=t.constructor;if(l!==c&&!(At(l)&&l instanceof l&&At(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return!1}r=r||[],n=n||[];for(var u=r.length;u--;)if(r[u]===e)return n[u]===t;if(r.push(e),n.push(t),a){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!w(e[u],t[u],r,n))return!1}else{var d,f=v(e);if(u=f.length,v(t).length!==u)return!1;for(;u--;)if(d=f[u],!s(t,d)||!w(e[d],t[d],r,n))return!1}return r.pop(),n.pop(),!0}function k(e,t){return w(e,t)}function _(e){if(!t(e))return[];var r=[];for(var n in e)r.push(n);return dt&&g(e,r),r}function C(e){for(var t=v(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=e[t[i]];return n}function U(e){for(var t=v(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=[t[i],e[t[i]]];return n}function S(e){for(var t={},r=v(e),n=0,i=r.length;n<i;n++)t[e[r[n]]]=r[n];return t}function B(e){var t=[];for(var r in e)At(e[r])&&t.push(r);return t.sort()}function I(e,t){return function(r){var n=arguments.length;if(t&&(r=Object(r)),n<2||null==r)return r;for(var i=1;i<n;i++)for(var o=arguments[i],a=e(o),s=a.length,l=0;l<s;l++){var c=a[l];t&&void 0!==r[c]||(r[c]=o[c])}return r}}function A(){return function(){}}function O(e){if(!t(e))return{};if(st)return st(e);var r=A();r.prototype=e;var n=new r;return r.prototype=null,n}function x(e,t){var r=O(e);return t&&Mt(r,t),r}function T(e){return t(e)?St(e)?e.slice():Wt({},e):e}function R(e,t){return t(e),e}function j(e,t){if(!St(t))return s(e,t);for(var r=t.length,n=0;n<r;n++){var i=t[n];if(null==e||!nt.call(e,i))return!1;e=e[i]}return!!r}function P(e){return e}function $(e){return e=Mt({},e),function(t){return m(t,e)}}function F(e,t){for(var r=t.length,n=0;n<r;n++){if(null==e)return;e=e[t[n]]}return r?e:void 0}function W(e){return St(e)?function(t){return F(t,e)}:f(e)}function M(e,t,r){if(void 0===t)return e;switch(null==r?3:r){case 1:return function(r){return e.call(t,r)};case 3:return function(r,n,i){return e.call(t,r,n,i)};case 4:return function(r,n,i,o){return e.call(t,r,n,i,o)}}return function(){return e.apply(t,arguments)}}function N(e,r,n){return null==e?P:At(e)?M(e,r,n):t(e)&&!St(e)?$(e):W(e)}function q(e,t){return N(e,t,1/0)}function L(e,t,r){return y.iteratee!==q?y.iteratee(e,t):N(e,t,r)}function H(e,t,r){t=L(t,r);for(var n=v(e),i=n.length,o={},a=0;a<i;a++){var s=n[a];o[s]=t(e[s],s,e)}return o}function K(){}function D(e){return null==e?function(){}:function(t){return St(t)?F(e,t):e[t]}}function V(e,t,r){var n=Array(Math.max(0,e));t=M(t,r,1);for(var i=0;i<e;i++)n[i]=t(i);return n}function J(e,t){return null==t&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}function Q(e){var t=function(t){return e[t]},r="(?:"+v(e).join("|")+")",n=RegExp(r),i=RegExp(r,"g");return function(e){return e=null==e?"":""+e,n.test(e)?e.replace(i,t):e}}function Y(e){return"\\"+Qt[e]}function z(e,t,r){!t&&r&&(t=r),t=Nt({},t,y.templateSettings);var n=RegExp([(t.escape||Jt).source,(t.interpolate||Jt).source,(t.evaluate||Jt).source].join("|")+"|$","g"),i=0,o="__p+='";e.replace(n,function(t,r,n,a,s){return o+=e.slice(i,s).replace(Yt,Y),i=s+t.length,r?o+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":n?o+="'+\n((__t=("+n+"))==null?'':__t)+\n'":a&&(o+="';\n"+a+"\n__p+='"),t}),o+="';\n",t.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";var a;try{a=new Function(t.variable||"obj","_",o)}catch(s){throw s.source=o,s}var l=function(e){return a.call(this,e,y)},c=t.variable||"obj";return l.source="function("+c+"){\n"+o+"}",l}function G(e,t,r){St(t)||(t=[t]);var n=t.length;if(!n)return At(r)?r.call(e):r;for(var i=0;i<n;i++){var o=null==e?void 0:e[t[i]];void 0===o&&(o=r,i=n),e=At(o)?o.call(e):o}return e}function X(e){var t=++zt+"";return e?e+t:t}function Z(e){var t=y(e);return t._chain=!0,t}function ee(e,r,n,i,o){if(!(i instanceof r))return e.apply(n,o);var a=O(e.prototype),s=e.apply(a,o);return t(s)?s:a}function te(e,t,r,n){if(n=n||[],t||0===t){if(t<=0)return n.concat(e)}else t=1/0;for(var i=n.length,o=0,a=$t(e);o<a;o++){var s=e[o];if(Ft(s)&&(St(s)||xt(s)))if(t>1)te(s,t-1,r,n),i=n.length;else for(var l=0,c=s.length;l<c;)n[i++]=s[l++];else r||(n[i++]=s)}return n}function re(e,t){var r=function(n){var i=r.cache,o=""+(t?t.apply(this,arguments):n);return s(i,o)||(i[o]=e.apply(this,arguments)),i[o]};return r.cache={},r}function ne(e,t,r){var n,i,o,a,s=0;r||(r={});var l=function(){s=r.leading===!1?0:qt(),n=null,a=e.apply(i,o),n||(i=o=null)},c=function(){var c=qt();s||r.leading!==!1||(s=c);var u=t-(c-s);return i=this,o=arguments,u<=0||u>t?(n&&(clearTimeout(n),n=null),s=c,a=e.apply(i,o),n||(i=o=null)):n||r.trailing===!1||(n=setTimeout(l,u)),a};return c.cancel=function(){clearTimeout(n),s=0,n=i=o=null},c}function ie(t,r,n){var i,o,a=function(e,r){i=null,r&&(o=t.apply(e,r))},s=e(function(e){if(i&&clearTimeout(i),n){var s=!i;i=setTimeout(a,r),s&&(o=t.apply(this,e))}else i=er(a,r,this,e);return o});return s.cancel=function(){clearTimeout(i),i=null},s}function oe(e,t){return Gt(t,e)}function ae(e){return function(){return!e.apply(this,arguments)}}function se(){var e=arguments,t=e.length-1;return function(){for(var r=t,n=e[t].apply(this,arguments);r--;)n=e[r].call(this,n);return n}}function le(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function ce(e,t){var r;return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}}function ue(e,t,r){t=L(t,r);for(var n,i=v(e),o=0,a=i.length;o<a;o++)if(n=i[o],t(e[n],n,e))return n}function de(e){return function(t,r,n){r=L(r,n);for(var i=$t(t),o=e>0?0:i-1;o>=0&&o<i;o+=e)if(r(t[o],o,t))return o;return-1}}function fe(e,t,r,n){r=L(r,n,1);for(var i=r(t),o=0,a=$t(e);o<a;){var s=Math.floor((o+a)/2);r(e[s])<i?o=s+1:a=s}return o}function pe(e,t,r){return function(n,i,o){var a=0,s=$t(n);if("number"==typeof o)e>0?a=o>=0?o:Math.max(o+s,a):s=o>=0?Math.min(o+1,s):o+s+1;else if(r&&o&&s)return o=r(n,i),n[o]===i?o:-1;if(i!==i)return o=t(tt.call(n,a,s),c),o>=0?o+a:-1;for(o=e>0?a:s-1;o>=0&&o<s;o+=e)if(n[o]===i)return o;return-1}}function be(e,t,r){var n=Ft(e)?nr:ue,i=n(e,t,r);if(void 0!==i&&i!==-1)return e[i]}function ge(e,t){return be(e,$(t))}function ve(e,t,r){t=M(t,r);var n,i;if(Ft(e))for(n=0,i=e.length;n<i;n++)t(e[n],n,e);else{var o=v(e);for(n=0,i=o.length;n<i;n++)t(e[o[n]],o[n],e)}return e}function he(e,t,r){t=L(t,r);for(var n=!Ft(e)&&v(e),i=(n||e).length,o=Array(i),a=0;a<i;a++){var s=n?n[a]:a;o[a]=t(e[s],s,e)}return o}function me(e){var t=function(t,r,n,i){var o=!Ft(t)&&v(t),a=(o||t).length,s=e>0?0:a-1;for(i||(n=t[o?o[s]:s],s+=e);s>=0&&s<a;s+=e){var l=o?o[s]:s;n=r(n,t[l],l,t)}return n};return function(e,r,n,i){var o=arguments.length>=3;return t(e,M(r,i,4),n,o)}}function ye(e,t,r){var n=[];return t=L(t,r),ve(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function we(e,t,r){return ye(e,ae(L(t)),r)}function Ee(e,t,r){t=L(t,r);for(var n=!Ft(e)&&v(e),i=(n||e).length,o=0;o<i;o++){var a=n?n[o]:o;if(!t(e[a],a,e))return!1}return!0}function ke(e,t,r){t=L(t,r);for(var n=!Ft(e)&&v(e),i=(n||e).length,o=0;o<i;o++){var a=n?n[o]:o;if(t(e[a],a,e))return!0}return!1}function _e(e,t,r,n){return Ft(e)||(e=C(e)),("number"!=typeof r||n)&&(r=0),or(e,t,r)>=0}function Ce(e,t){return he(e,W(t))}function Ue(e,t){return ye(e,$(t))}function Se(e,t,r){var n,i,o=-(1/0),a=-(1/0);if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e){e=Ft(e)?e:C(e);for(var s=0,l=e.length;s<l;s++)n=e[s],null!=n&&n>o&&(o=n)}else t=L(t,r),ve(e,function(e,r,n){i=t(e,r,n),(i>a||i===-(1/0)&&o===-(1/0))&&(o=e,a=i)});return o}function Be(e,t,r){var n,i,o=1/0,a=1/0;if(null==t||"number"==typeof t&&"object"!=typeof e[0]&&null!=e){e=Ft(e)?e:C(e);for(var s=0,l=e.length;s<l;s++)n=e[s],null!=n&&n<o&&(o=n)}else t=L(t,r),ve(e,function(e,r,n){i=t(e,r,n),(i<a||i===1/0&&o===1/0)&&(o=e,a=i)});return o}function Ie(e,t,r){if(null==t||r)return Ft(e)||(e=C(e)),e[J(e.length-1)];var n=Ft(e)?T(e):C(e),i=$t(n);t=Math.max(Math.min(t,i),0);for(var o=i-1,a=0;a<t;a++){var s=J(a,o),l=n[a];n[a]=n[s],n[s]=l}return n.slice(0,t)}function Ae(e){return Ie(e,1/0)}function Oe(e,t,r){var n=0;return t=L(t,r),Ce(he(e,function(e,r,i){return{value:e,index:n++,criteria:t(e,r,i)}}).sort(function(e,t){var r=e.criteria,n=t.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(r<n||void 0===n)return-1}return e.index-t.index}),"value")}function xe(e,t){return function(r,n,i){var o=t?[[],[]]:{};return n=L(n,i),ve(r,function(t,i){var a=n(t,i,r);e(o,t,a)}),o}}function Te(e){return e?St(e)?tt.call(e):bt(e)?e.match(br):Ft(e)?he(e,P):C(e):[]}function Re(e){return null==e?0:Ft(e)?e.length:v(e).length}function je(e,t,r){return t in r}function Pe(e,t,r){return tt.call(e,0,Math.max(0,e.length-(null==t||r?1:t)))}function $e(e,t,r){return null==e||e.length<1?null==t||r?void 0:[]:null==t||r?e[0]:Pe(e,e.length-t)}function Fe(e,t,r){return tt.call(e,null==t||r?1:t)}function We(e,t,r){return null==e||e.length<1?null==t||r?void 0:[]:null==t||r?e[e.length-1]:Fe(e,Math.max(0,e.length-t))}function Me(e){return ye(e,Boolean)}function Ne(e,t){return te(e,t,!1)}function qe(e,t,r,n){i(t)||(n=r,r=t,t=!1),null!=r&&(r=L(r,n));for(var o=[],a=[],s=0,l=$t(e);s<l;s++){var c=e[s],u=r?r(c,s,e):c;t&&!r?(s&&a===u||o.push(c),a=u):r?_e(a,u)||(a.push(u),o.push(c)):_e(o,c)||o.push(c)}return o}function Le(e){for(var t=[],r=arguments.length,n=0,i=$t(e);n<i;n++){var o=e[n];if(!_e(t,o)){var a;for(a=1;a<r&&_e(arguments[a],o);a++);a===r&&t.push(o)}}return t}function He(e){for(var t=e&&Se(e,$t).length||0,r=Array(t),n=0;n<t;n++)r[n]=Ce(e,n);return r}function Ke(e,t){for(var r={},n=0,i=$t(e);n<i;n++)t?r[e[n]]=t[n]:r[e[n][0]]=e[n][1];return r}function De(e,t,r){null==t&&(t=e||0,e=0),r||(r=t<e?-1:1);for(var n=Math.max(Math.ceil((t-e)/r),0),i=Array(n),o=0;o<n;o++,e+=r)i[o]=e;return i}function Ve(e,t){if(null==t||t<1)return[];for(var r=[],n=0,i=e.length;n<i;)r.push(tt.call(e,n,n+=t));return r}function Je(e,t){return e._chain?y(t).chain():t}function Qe(e){return ve(B(e),function(t){var r=y[t]=e[t];y.prototype[t]=function(){var e=[this._wrapped];return et.apply(e,arguments),Je(this,r.apply(y,e))}}),y}var Ye="1.11.0",ze="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},Ge=Array.prototype,Xe=Object.prototype,Ze="undefined"!=typeof Symbol?Symbol.prototype:null,et=Ge.push,tt=Ge.slice,rt=Xe.toString,nt=Xe.hasOwnProperty,it="undefined"!=typeof ArrayBuffer,ot=Array.isArray,at=Object.keys,st=Object.create,lt=it&&ArrayBuffer.isView,ct=isNaN,ut=isFinite,dt=!{toString:null}.propertyIsEnumerable("toString"),ft=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],pt=Math.pow(2,53)-1,bt=a("String"),gt=a("Number"),vt=a("Date"),ht=a("RegExp"),mt=a("Error"),yt=a("Symbol"),wt=a("Map"),Et=a("WeakMap"),kt=a("Set"),_t=a("WeakSet"),Ct=a("ArrayBuffer"),Ut=a("DataView"),St=ot||a("Array"),Bt=a("Function"),It=ze.document&&ze.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof It&&(Bt=function(e){return"function"==typeof e||!1});var At=Bt,Ot=a("Arguments");!function(){Ot(arguments)||(Ot=function(e){return s(e,"callee")})}();var xt=Ot,Tt=f("byteLength"),Rt=d(Tt),jt=/\[object ((I|Ui)nt(8|16|32)|Float(32|64)|Uint8Clamped|Big(I|Ui)nt64)Array\]/,Pt=it?p:u(!1),$t=f("length"),Ft=d($t);y.VERSION=Ye,y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return String(this._wrapped)};var Wt=I(_),Mt=I(v),Nt=I(_,!0);y.iteratee=q;var qt=Date.now||function(){return(new Date).getTime()},Lt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},Ht=Q(Lt),Kt=S(Lt),Dt=Q(Kt),Vt=y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},Jt=/(.)^/,Qt={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Yt=/\\|'|\r|\n|\u2028|\u2029/g,zt=0,Gt=e(function(e,t){var r=Gt.placeholder,n=function(){for(var i=0,o=t.length,a=Array(o),s=0;s<o;s++)a[s]=t[s]===r?arguments[i++]:t[s];for(;i<arguments.length;)a.push(arguments[i++]);return ee(e,n,this,this,a)};return n});Gt.placeholder=y;var Xt=e(function(t,r,n){if(!At(t))throw new TypeError("Bind must be called on a function");var i=e(function(e){return ee(t,i,r,this,n.concat(e))});return i}),Zt=e(function(e,t){t=te(t,!1,!1);var r=t.length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=t[r];e[n]=Xt(e[n],e)}return e}),er=e(function(e,t,r){return setTimeout(function(){return e.apply(null,r)},t)}),tr=Gt(er,y,1),rr=Gt(ce,2),nr=de(1),ir=de(-1),or=pe(1,nr,fe),ar=pe(-1,ir),sr=me(1),lr=me(-1),cr=e(function(e,t,r){var n,i;return At(t)?i=t:St(t)&&(n=t.slice(0,-1),t=t[t.length-1]),he(e,function(e){var o=i;if(!o){if(n&&n.length&&(e=F(e,n)),null==e)return;o=e[t]}return null==o?o:o.apply(e,r)})}),ur=xe(function(e,t,r){s(e,r)?e[r].push(t):e[r]=[t]}),dr=xe(function(e,t,r){e[r]=t}),fr=xe(function(e,t,r){s(e,r)?e[r]++:e[r]=1}),pr=xe(function(e,t,r){e[r?0:1].push(t)},!0),br=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g,gr=e(function(e,t){var r={},n=t[0];if(null==e)return r;At(n)?(t.length>1&&(n=M(n,t[1])),t=_(e)):(n=je,t=te(t,!1,!1),e=Object(e));for(var i=0,o=t.length;i<o;i++){var a=t[i],s=e[a];n(s,a,e)&&(r[a]=s)}return r}),vr=e(function(e,t){var r,n=t[0];return At(n)?(n=ae(n),t.length>1&&(r=t[1])):(t=he(te(t,!1,!1),String),n=function(e,r){return!_e(t,r)}),gr(e,n,r)}),hr=e(function(e,t){return t=te(t,!0,!0),ye(e,function(e){return!_e(t,e)})}),mr=e(function(e,t){return hr(e,t)}),yr=e(function(e){return qe(te(e,!0,!0))}),wr=e(He);ve(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=Ge[e];y.prototype[e]=function(){var r=this._wrapped;return null!=r&&(t.apply(r,arguments),"shift"!==e&&"splice"!==e||0!==r.length||delete r[0]),Je(this,r)}}),ve(["concat","join","slice"],function(e){var t=Ge[e];y.prototype[e]=function(){var e=this._wrapped;return null!=e&&(e=t.apply(e,arguments)),Je(this,e)}});var Er={__proto__:null,VERSION:Ye,restArguments:e,isObject:t,isNull:r,isUndefined:n,isBoolean:i,isElement:o,isString:bt,isNumber:gt,isDate:vt,isRegExp:ht,isError:mt,isSymbol:yt,isMap:wt,isWeakMap:Et,isSet:kt,isWeakSet:_t,isArrayBuffer:Ct,isDataView:Ut,isArray:St,isFunction:At,isArguments:xt,isFinite:l,isNaN:c,isTypedArray:Pt,isEmpty:h,isMatch:m,isEqual:k,keys:v,allKeys:_,values:C,pairs:U,invert:S,functions:B,methods:B,extend:Wt,extendOwn:Mt,assign:Mt,defaults:Nt,create:x,clone:T,tap:R,has:j,mapObject:H,identity:P,constant:u,noop:K,property:W,propertyOf:D,matcher:$,matches:$,times:V,random:J,now:qt,escape:Ht,unescape:Dt,templateSettings:Vt,template:z,result:G,uniqueId:X,chain:Z,iteratee:q,partial:Gt,bind:Xt,bindAll:Zt,memoize:re,delay:er,defer:tr,throttle:ne,debounce:ie,wrap:oe,negate:ae,compose:se,after:le,before:ce,once:rr,findKey:ue,findIndex:nr,findLastIndex:ir,sortedIndex:fe,indexOf:or,lastIndexOf:ar,find:be,detect:be,findWhere:ge,each:ve,forEach:ve,map:he,collect:he,reduce:sr,foldl:sr,inject:sr,reduceRight:lr,foldr:lr,filter:ye,select:ye,reject:we,every:Ee,all:Ee,some:ke,any:ke,contains:_e,includes:_e,include:_e,invoke:cr,pluck:Ce,where:Ue,max:Se,min:Be,shuffle:Ae,sample:Ie,sortBy:Oe,groupBy:ur,indexBy:dr,countBy:fr,partition:pr,toArray:Te,size:Re,pick:gr,omit:vr,first:$e,head:$e,take:$e,initial:Pe,last:We,rest:Fe,tail:Fe,drop:Fe,compact:Me,flatten:Ne,without:mr,uniq:qe,unique:qe,union:yr,intersection:Le,difference:hr,unzip:He,transpose:He,zip:wr,object:Ke,range:De,chunk:Ve,mixin:Qe,"default":y},kr=Qe(Er);return kr._=kr,kr});var Arrive=function(e,t,r){"use strict";function n(e,t,r){a.addMethod(t,r,e.unbindEvent),a.addMethod(t,r,e.unbindEventWithSelectorOrCallback),a.addMethod(t,r,e.unbindEventWithSelectorAndCallback)}function i(e){e.arrive=d.bindEvent,n(d,e,"unbindArrive"),e.leave=f.bindEvent,n(f,e,"unbindLeave")}if(e.MutationObserver&&"undefined"!=typeof HTMLElement){var o=0,a=function(){var t=HTMLElement.prototype.matches||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector;return{matchesSelector:function(e,r){return e instanceof HTMLElement&&t.call(e,r)},addMethod:function(e,t,n){var i=e[t];e[t]=function(){return n.length==arguments.length?n.apply(this,arguments):"function"==typeof i?i.apply(this,arguments):r}},callCallbacks:function(e,t){t&&t.options.onceOnly&&1==t.firedElems.length&&(e=[e[0]]);for(var r,n=0;r=e[n];n++)r&&r.callback&&r.callback.call(r.elem,r.elem);t&&t.options.onceOnly&&1==t.firedElems.length&&t.me.unbindEventWithSelectorAndCallback.call(t.target,t.selector,t.callback)},checkChildNodesRecursively:function(e,t,r,n){for(var i,o=0;i=e[o];o++)r(i,t,n)&&n.push({callback:t.callback,elem:i}),i.childNodes.length>0&&a.checkChildNodesRecursively(i.childNodes,t,r,n)},mergeArrays:function(e,t){var r,n={};for(r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);for(r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n},toElementsArray:function(t){return r===t||"number"==typeof t.length&&t!==e||(t=[t]),t}}}(),s=function(){var e=function(){this._eventsBucket=[],this._beforeAdding=null,this._beforeRemoving=null};return e.prototype.addEvent=function(e,t,r,n){var i={target:e,selector:t,options:r,callback:n,firedElems:[]};return this._beforeAdding&&this._beforeAdding(i),this._eventsBucket.push(i),i},e.prototype.removeEvent=function(e){for(var t,r=this._eventsBucket.length-1;t=this._eventsBucket[r];r--)if(e(t)){this._beforeRemoving&&this._beforeRemoving(t);var n=this._eventsBucket.splice(r,1);n&&n.length&&(n[0].callback=null)}},e.prototype.beforeAdding=function(e){this._beforeAdding=e},e.prototype.beforeRemoving=function(e){this._beforeRemoving=e},e}(),l=function(t,n){var i=new s,o=this,l={fireOnAttributesModification:!1};return i.beforeAdding(function(r){var i,a=r.target;(a===e.document||a===e)&&(a=document.getElementsByTagName("html")[0]),i=new MutationObserver(function(e){n.call(this,e,r)});var s=t(r.options);i.observe(a,s),r.observer=i,r.me=o}),i.beforeRemoving(function(e){e.observer.disconnect()}),this.bindEvent=function(e,t,r){t=a.mergeArrays(l,t);for(var n=a.toElementsArray(this),o=0;o<n.length;o++)i.addEvent(n[o],e,t,r)},this.unbindEvent=function(){var e=a.toElementsArray(this);i.removeEvent(function(t){for(var n=0;n<e.length;n++)if(this===r||t.target===e[n])return!0;return!1})},this.unbindEventWithSelectorOrCallback=function(e){var t,n=a.toElementsArray(this),o=e;t="function"==typeof e?function(e){for(var t=0;t<n.length;t++)if((this===r||e.target===n[t])&&e.callback===o)return!0;return!1}:function(t){for(var i=0;i<n.length;i++)if((this===r||t.target===n[i])&&t.selector===e)return!0;return!1},i.removeEvent(t)},this.unbindEventWithSelectorAndCallback=function(e,t){var n=a.toElementsArray(this);i.removeEvent(function(i){for(var o=0;o<n.length;o++)if((this===r||i.target===n[o])&&i.selector===e&&i.callback===t)return!0;return!1})},this},c=function(){function e(e){var t={attributes:!1,childList:!0,subtree:!0};return e.fireOnAttributesModification&&(t.attributes=!0),t}function t(e,t){e.forEach(function(e){var r=e.addedNodes,i=e.target,o=[];null!==r&&r.length>0?a.checkChildNodesRecursively(r,t,n,o):"attributes"===e.type&&n(i,t,o)&&o.push({callback:t.callback,elem:i}),a.callCallbacks(o,t)})}function n(e,t){return!(!a.matchesSelector(e,t.selector)||(e._id===r&&(e._id=o++),-1!=t.firedElems.indexOf(e._id)))&&(t.firedElems.push(e._id),!0)}var i={fireOnAttributesModification:!1,onceOnly:!1,existing:!1};d=new l(e,t);var s=d.bindEvent;return d.bindEvent=function(e,t,n){r===n?(n=t,t=i):t=a.mergeArrays(i,t);var o=a.toElementsArray(this);if(t.existing){for(var l=[],c=0;c<o.length;c++)for(var u=o[c].querySelectorAll(e),d=0;d<u.length;d++)l.push({callback:n,elem:u[d]});if(t.onceOnly&&l.length)return n.call(l[0].elem,l[0].elem);setTimeout(a.callCallbacks,1,l)}s.call(this,e,t,n)},d},u=function(){function e(){var e={childList:!0,subtree:!0};return e}function t(e,t){e.forEach(function(e){var r=e.removedNodes,i=[];null!==r&&r.length>0&&a.checkChildNodesRecursively(r,t,n,i),a.callCallbacks(i,t)})}function n(e,t){return a.matchesSelector(e,t.selector)}var i={};f=new l(e,t);var o=f.bindEvent;return f.bindEvent=function(e,t,n){r===n?(n=t,t=i):t=a.mergeArrays(i,t),o.call(this,e,t,n)},f},d=new c,f=new u;t&&i(t.fn),i(HTMLElement.prototype),i(NodeList.prototype),i(HTMLCollection.prototype),i(HTMLDocument.prototype),i(Window.prototype);var p={};return n(d,p,"unbindAllArrive"),n(f,p,"unbindAllLeave"),p}}(window,"undefined"==typeof jQuery?null:jQuery,void 0);"object"!=typeof ebJSON&&(ebJSON={}),function(){"use strict";function f(e){return e<10?"0"+e:e}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var r,n,i,o,a,s=gap,l=t[e];switch(l&&"object"==typeof l&&"function"==typeof l.toebJSON&&(l=l.toebJSON(e)),"function"==typeof rep&&(l=rep.call(t,e,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":case"null":return String(l);case"object":if(!l)return"null";if(gap+=indent,a=[],"[object Array]"===Object.prototype.toString.apply(l)){for(o=l.length,r=0;r<o;r+=1)a[r]=str(r,l)||"null";return i=0===a.length?"[]":gap?"[\n"+gap+a.join(",\n"+gap)+"\n"+s+"]":"["+a.join(",")+"]",gap=s,i}if(rep&&"object"==typeof rep)for(o=rep.length,r=0;r<o;r+=1)"string"==typeof rep[r]&&(n=rep[r],i=str(n,l),i&&a.push(quote(n)+(gap?": ":":")+i));else for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(i=str(n,l),i&&a.push(quote(n)+(gap?": ":":")+i));return i=0===a.length?"{}":gap?"{\n"+gap+a.join(",\n"+gap)+"\n"+s+"}":"{"+a.join(",")+"}",gap=s,i}}"function"!=typeof Date.prototype.toebJSON&&(Date.prototype.toebJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toebJSON=Number.prototype.toebJSON=Boolean.prototype.toebJSON=function(){return this.valueOf()});var cx,escapable,gap,indent,meta,rep;"function"!=typeof ebJSON.stringify&&(escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},ebJSON.stringify=function(e,t,r){var n;if(gap="",indent="","number"==typeof r)for(n=0;n<r;n+=1)indent+=" ";else"string"==typeof r&&(indent=r);if(rep=t,t&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("ebJSON.stringify");return str("",{"":e})}),"function"!=typeof ebJSON.parse&&(cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,ebJSON.parse=function(text,reviver){function walk(e,t){var r,n,i=e[t];if(i&&"object"==typeof i)for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n=walk(i,r),void 0!==n?i[r]=n:delete i[r]);return reviver.call(e,t,i)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("ebebJSON.parse")})}();var EarlyBirdsQueue=function(e){this.eb=e};EarlyBirdsQueue.prototype.push=function(){for(var e=this,t=0;t<arguments.length;t++)try{if("function"==typeof arguments[t])arguments[t]();else{var r=arguments[t][0];e.eb[r].apply(e.eb,arguments[t].slice(1))}}catch(n){e.eb.ebUtils.log(n)}};var EarlyBirdsUtils=function(e){this.eb=e,Function.prototype.bind&&window.console&&"object"==typeof window.console.log&&["log","info","warn","error","assert","dir","clear","profile","profileEnd"].forEach(function(e){window.console[e]=this.call(window.console[e],window.console)},Function.prototype.bind)};EarlyBirdsUtils.isIE8=function(){return(!Function.prototype.bind||Function.prototype.bind&&"undefined"==typeof window.addEventListener)&&"object"==typeof console&&"object"==typeof console.log},EarlyBirdsUtils.isIE=function(){var e=navigator.userAgent.toLowerCase();return e.indexOf("msie")!=-1&&parseInt(e.split("msie")[1])},EarlyBirdsUtils.prototype.eb=null,EarlyBirdsUtils.prototype.vargs=function(e){var t=Array.prototype.slice,r=e.length;return function(){var n=arguments.length,i=arguments[n-1];if(n>=r||"function"!=typeof i)return e.apply(this,arguments);for(var o=t.call(arguments,0,n-1),a=r-n;a;a-=1)o.push(void 0);return o.push(i),e.apply(this,o)}},EarlyBirdsUtils.prototype.getXMLHttpRequest=function(e,t){var r,n=this,i="",o=function(e){if(4===r.readyState){try{i=JSON.parse(r.responseText)}catch(e){i=r.responseText}if(200===r.status)t&&t(null,i);else{var o="Bad HTTP status: "+r.status+" "+r.statusText;n.logError(o),t&&t(new Error(o),i)}}};if(e&&EarlyBirdsUtils.isIE()&&EarlyBirdsUtils.isIE()<=9&&window.XDomainRequest)r=new window.XDomainRequest,r.onload=function(){try{i=JSON.parse(r.responseText)}catch(e){i=r.responseText}t(null,i)},r.onerror=function(){n.logError("XDomainRequest failed")},r.ontimeout=function(){n.logError("XDomainRequest timeout")},r.onprogress=function(){};else if(window.XMLHttpRequest)r=new window.XMLHttpRequest,r.onreadystatechange=o;else try{r=new ActiveXObject("MSXML2.XMLHTTP.3.0"),r.onreadystatechange=o}catch(a){return null}return r},EarlyBirdsUtils.prototype.sendRequest=EarlyBirdsUtils.prototype.vargs(function(e,t,r,n){var i=this;t=t.replace("cdn.early-birds.io","cdn.early-birds.io");var o;if(o=t.indexOf(document.location.hostname)!=-1?this.getXMLHttpRequest(!1,n):this.getXMLHttpRequest(!0,n),"undefined"==typeof r)r=null;else try{r=ebJSON.stringify(r)}catch(a){}if("//"==t.substring(0,2)&&(t=HTTP_PROTOCOL+t.substring(2,t.length)),null!==o)try{o.open(e,t,!0),t.indexOf("api.early")>=0&&o.setRequestHeader("Content-Type","text/plain"),"undefined"!=typeof o.withCredentials&&(o.withCredentials=!0),o.send(r)}catch(a){i.log(a)}else n(new Error("Request is null"))}),EarlyBirdsUtils.prototype.isConsoleLog=function(){var e=navigator.userAgent,t=/Windows\sNT\s(\d+\.\d+)/;console&&console.log&&/MSIE\s(\d+)/.test(e)&&t.test(e)&&parseFloat(t.exec(e)[1])>=6.1&&(this.isIECompatibilityView=!0)},EarlyBirdsUtils.prototype.dispatchEvent=function(e,t){window.ebExtensionInjected===!0&&"function"==typeof document.dispatchEvent&&"function"==typeof window.CustomEvent&&document.dispatchEvent(new CustomEvent(e,{detail:t}))},EarlyBirdsUtils.prototype.log=function(){if(this.eb.debug&&"undefined"!==window.console&&window.console)if(EarlyBirdsUtils.isIE8())Function.prototype.call.call(console.log,console,Array.prototype.slice.call(args));else try{1===arguments.length&&"string"==typeof arguments[0]?window.console.log.apply(window.console,["[EarlyBirds] : "+arguments[0]]):(window.console.log.apply(window.console,["[EarlyBirds] : "]),window.console.log.apply(window.console,arguments))}catch(e){this.eb._.each(arguments,function(e){window.console.log(e)})}},EarlyBirdsUtils.prototype.logError=function(){if(this.eb.debug&&"undefined"!==window.console&&window.console){var e=["[Earlybirds] - Error :"].concat(this.eb._.toArray(arguments));if(EarlyBirdsUtils.isIE8())Function.prototype.call.call(console.log,console,Array.prototype.slice.call(e));else try{
"undefined"!=typeof window.console.error?window.console.error.apply(window.console,e):window.console.log.apply(window.console,e)}catch(t){}}},EarlyBirdsUtils.prototype.parseErrorsThenCallback=function(e,t,r){e(t,r)},EarlyBirdsUtils.prototype.hashCode=function(e){var t,r,n,i=0;if(0===e.length)return i;for(t=0,n=e.length;t<n;t++)r=e.charCodeAt(t),i=(i<<5)-i+r,i|=0;return i},EarlyBirdsUtils.prototype.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},EarlyBirdsUtils.prototype.truncate=function(e,t){return e.length>t?e.substring(0,t)+"...":e},EarlyBirdsUtils.prototype.clone=function(e){if(null===e||"object"!=typeof e)return e;var t=e.constructor();for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t},EarlyBirdsUtils.prototype.loadScript=function(e,t){if(0===this.eb.$('script[src*="'+e+'"]').length){var r=document.createElement("script");r.type="text/javascript",t&&(r.readyState?r.onreadystatechange=function(){"loaded"!=r.readyState&&"complete"!=r.readyState||(r.onreadystatechange=null,t())}:r.onload=function(){t()}),r.src=e,document.getElementsByTagName("head")[0].appendChild(r)}else t()},EarlyBirdsUtils.prototype.placeholderFromUrlParam=function(e){for(var t=null,r=/{{.*?}}/g;null!==(t=r.exec(e));)e=e.replace(t[0],this.getParamByName(t[0].replace(/({{|}})/g,"")));return e},EarlyBirdsUtils.prototype.getParamByName=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)"),r=t.exec(location.search);return null===r?"":decodeURIComponent(r[1].replace(/\+/g," "))},EarlyBirdsUtils.prototype.testLocalStorage=function(){var e="$earlybirds$";try{return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(t){return!1}},EarlyBirdsUtils.prototype.addPropertiesToObject=function(e,t,r,n){for(var i=0;i<r.length;i++)void 0!==typeof t[r[i]]&&t[r[i]]&&(e[n+r[i]]=t[r[i]]);return e},EarlyBirdsUtils.prototype.getNavigatorSegments=function(){var e={},t=["appCodeName","appName","appVersion","cookieEnabled","doNotTrack","language","platform","product","productSub","userAgent","vendor","vendorSub"];return this.addPropertiesToObject(e,window.navigator,t,"navigator_"),e.navigator_localStorageEnabled=this.testLocalStorage(),window.screen.width&&window.screen.height&&(e.screen_resolution=window.screen.width+"x"+window.screen.height),e},EarlyBirdsUtils.prototype.getFingerPrint=function(e){try{(new Fingerprint2).get(function(t){return e(t)})}catch(t){return e(null)}},EarlyBirdsUtils.prototype.fireWhenSelectorIsReady=function(e,t){if("undefined"==typeof document.arrive){var r=function(){return this.eb.$.find(e).length>0?t():void window.setTimeout(r,200)};r()}else document.arrive(e,{existing:!0,onceOnly:!0},function(){return t()})},EarlyBirdsUtils.prototype.fireWhenConditionTrue=function(e,t,r){var n=function(){e()===!0?r():window.setTimeout(n,t)};n()},EarlyBirdsUtils.prototype.compareVersion=function(e,t){for(var r=e.split("."),n=t.split("."),i=0;i<3;i++){var o=Number(r[i]),a=Number(n[i]);if(o>a)return 1;if(a>o)return-1;if(!isNaN(o)&&isNaN(a))return 1;if(isNaN(o)&&!isNaN(a))return-1}return 0},function(e){function t(e){return n?n[e]:(n=require("unicode/category/So"),i=["sign","cross","of","symbol","staff","hand","black","white"].map(function(e){return new RegExp(e,"gi")}),n[e])}function r(e,n){e=e.toString(),"string"==typeof n&&(n={replacement:n}),n=n||{},n.mode=n.mode||r.defaults.mode;for(var o,a=r.defaults.modes[n.mode],s=["replacement","multicharmap","charmap","remove","lower"],l=0,c=s.length;l<c;l++)o=s[l],n[o]=o in n?n[o]:a[o];"undefined"==typeof n.symbols&&(n.symbols=a.symbols);var u=[];for(var o in n.multicharmap)if(n.multicharmap.hasOwnProperty(o)){var d=o.length;u.indexOf(d)===-1&&u.push(d)}for(var f,p,b,g="",l=0,c=e.length;l<c;l++){if(b=e[l],!u.some(function(t){var r=e.substr(l,t);return!!n.multicharmap[r]&&(l+=t-1,b=n.multicharmap[r],!0)})&&(n.charmap[b]?(b=n.charmap[b],f=b.charCodeAt(0)):f=e.charCodeAt(l),n.symbols&&(p=t(f)))){b=p.name.toLowerCase();for(var v=0,h=i.length;v<h;v++)b=b.replace(i[v],"");b=b.replace(/^\s+|\s+$/g,"")}b=b.replace(/[^\w\s\-\.\_~]/g,""),n.remove&&(b=b.replace(n.remove,"")),g+=b}return g=g.replace(/^\s+|\s+$/g,""),g=g.replace(/[-\s]+/g,n.replacement),g=g.replace(n.replacement+"$",""),n.lower&&(g=g.toLowerCase()),g}var n,i;if(r.defaults={mode:"pretty"},r.multicharmap=r.defaults.multicharmap={"<3":"love","&&":"and","||":"or","w/":"with"},r.charmap=r.defaults.charmap={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Æ":"AE","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ð":"D","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ő":"O","Ø":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ű":"U","Ý":"Y","Þ":"TH","ß":"ss","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","æ":"ae","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ð":"d","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ő":"o","ø":"o","ù":"u","ú":"u","û":"u","ü":"u","ű":"u","ý":"y","þ":"th","ÿ":"y","ẞ":"SS","α":"a","β":"b","γ":"g","δ":"d","ε":"e","ζ":"z","η":"h","θ":"8","ι":"i","κ":"k","λ":"l","μ":"m","ν":"n","ξ":"3","ο":"o","π":"p","ρ":"r","σ":"s","τ":"t","υ":"y","φ":"f","χ":"x","ψ":"ps","ω":"w","ά":"a","έ":"e","ί":"i","ό":"o","ύ":"y","ή":"h","ώ":"w","ς":"s","ϊ":"i","ΰ":"y","ϋ":"y","ΐ":"i","Α":"A","Β":"B","Γ":"G","Δ":"D","Ε":"E","Ζ":"Z","Η":"H","Θ":"8","Ι":"I","Κ":"K","Λ":"L","Μ":"M","Ν":"N","Ξ":"3","Ο":"O","Π":"P","Ρ":"R","Σ":"S","Τ":"T","Υ":"Y","Φ":"F","Χ":"X","Ψ":"PS","Ω":"W","Ά":"A","Έ":"E","Ί":"I","Ό":"O","Ύ":"Y","Ή":"H","Ώ":"W","Ϊ":"I","Ϋ":"Y","ş":"s","Ş":"S","ı":"i","İ":"I","ğ":"g","Ğ":"G","а":"a","б":"b","в":"v","г":"g","д":"d","е":"e","ё":"yo","ж":"zh","з":"z","и":"i","й":"j","к":"k","л":"l","м":"m","н":"n","о":"o","п":"p","р":"r","с":"s","т":"t","у":"u","ф":"f","х":"h","ц":"c","ч":"ch","ш":"sh","щ":"sh","ъ":"u","ы":"y","ь":"","э":"e","ю":"yu","я":"ya","А":"A","Б":"B","В":"V","Г":"G","Д":"D","Е":"E","Ё":"Yo","Ж":"Zh","З":"Z","И":"I","Й":"J","К":"K","Л":"L","М":"M","Н":"N","О":"O","П":"P","Р":"R","С":"S","Т":"T","У":"U","Ф":"F","Х":"H","Ц":"C","Ч":"Ch","Ш":"Sh","Щ":"Sh","Ъ":"U","Ы":"Y","Ь":"","Э":"E","Ю":"Yu","Я":"Ya","Є":"Ye","І":"I","Ї":"Yi","Ґ":"G","є":"ye","і":"i","ї":"yi","ґ":"g","č":"c","ď":"d","ě":"e","ň":"n","ř":"r","š":"s","ť":"t","ů":"u","ž":"z","Č":"C","Ď":"D","Ě":"E","Ň":"N","Ř":"R","Š":"S","Ť":"T","Ů":"U","Ž":"Z","ą":"a","ć":"c","ę":"e","ł":"l","ń":"n","ś":"s","ź":"z","ż":"z","Ą":"A","Ć":"C","Ę":"E","Ł":"L","Ń":"N","Ś":"S","Ź":"Z","Ż":"Z","ā":"a","ē":"e","ģ":"g","ī":"i","ķ":"k","ļ":"l","ņ":"n","ū":"u","Ā":"A","Ē":"E","Ģ":"G","Ī":"I","Ķ":"K","Ļ":"L","Ņ":"N","Ū":"U","ė":"e","į":"i","ų":"u","Ė":"E","Į":"I","Ų":"U","ț":"t","Ț":"T","ţ":"t","Ţ":"T","ș":"s","Ș":"S","ă":"a","Ă":"A","Ạ":"A","Ả":"A","Ầ":"A","Ấ":"A","Ậ":"A","Ẩ":"A","Ẫ":"A","Ằ":"A","Ắ":"A","Ặ":"A","Ẳ":"A","Ẵ":"A","Ẹ":"E","Ẻ":"E","Ẽ":"E","Ề":"E","Ế":"E","Ệ":"E","Ể":"E","Ễ":"E","Ị":"I","Ỉ":"I","Ĩ":"I","Ọ":"O","Ỏ":"O","Ồ":"O","Ố":"O","Ộ":"O","Ổ":"O","Ỗ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ợ":"O","Ở":"O","Ỡ":"O","Ụ":"U","Ủ":"U","Ũ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ự":"U","Ử":"U","Ữ":"U","Ỳ":"Y","Ỵ":"Y","Ỷ":"Y","Ỹ":"Y","Đ":"D","ạ":"a","ả":"a","ầ":"a","ấ":"a","ậ":"a","ẩ":"a","ẫ":"a","ằ":"a","ắ":"a","ặ":"a","ẳ":"a","ẵ":"a","ẹ":"e","ẻ":"e","ẽ":"e","ề":"e","ế":"e","ệ":"e","ể":"e","ễ":"e","ị":"i","ỉ":"i","ĩ":"i","ọ":"o","ỏ":"o","ồ":"o","ố":"o","ộ":"o","ổ":"o","ỗ":"o","ơ":"o","ờ":"o","ớ":"o","ợ":"o","ở":"o","ỡ":"o","ụ":"u","ủ":"u","ũ":"u","ư":"u","ừ":"u","ứ":"u","ự":"u","ử":"u","ữ":"u","ỳ":"y","ỵ":"y","ỷ":"y","ỹ":"y","đ":"d","€":"euro","₢":"cruzeiro","₣":"french franc","£":"pound","₤":"lira","₥":"mill","₦":"naira","₧":"peseta","₨":"rupee","₩":"won","₪":"new shequel","₫":"dong","₭":"kip","₮":"tugrik","₯":"drachma","₰":"penny","₱":"peso","₲":"guarani","₳":"austral","₴":"hryvnia","₵":"cedi","¢":"cent","¥":"yen","元":"yuan","円":"yen","﷼":"rial","₠":"ecu","¤":"currency","฿":"baht",$:"dollar","₹":"indian rupee","©":"(c)","œ":"oe","Œ":"OE","∑":"sum","®":"(r)","†":"+","“":'"',"”":'"',"‘":"'","’":"'","∂":"d","ƒ":"f","™":"tm","℠":"sm","…":"...","˚":"o","º":"o","ª":"a","•":"*","∆":"delta","∞":"infinity","♥":"love","&":"and","|":"or","<":"less",">":"greater"},r.defaults.modes={rfc3986:{replacement:"-",symbols:!0,remove:null,lower:!0,charmap:r.defaults.charmap,multicharmap:r.defaults.multicharmap},pretty:{replacement:"-",symbols:!0,remove:/[.]/g,lower:!1,charmap:r.defaults.charmap,multicharmap:r.defaults.multicharmap}},"undefined"!=typeof define&&define.amd){for(var o in r.defaults.modes)r.defaults.modes.hasOwnProperty(o)&&(r.defaults.modes[o].symbols=!1);define([],function(){return r})}else if("undefined"!=typeof module&&module.exports)t(),module.exports=r;else{for(var o in r.defaults.modes)r.defaults.modes.hasOwnProperty(o)&&(r.defaults.modes[o].symbols=!1);e.prototype.slug=r}}(EarlyBirdsUtils);var EarlyBirdsWidgets=function(e){this.eb=e,this.personalshopperResultLoaded=!1,this.template={},this.compiledTemplate={},this.widgets={}};EarlyBirdsWidgets.prototype.loadWidget=function(e,t){var r=this,n=r.eb;if(n.ebUtils.log("widget:loadWidget",e),e.widgetId&&(e.widgetKey=e.widgetId,delete e.widgetId),e.widgetKey&&"570fbe24eb5a8cc84f161a65"!==e.widgetKey)switch(e.preLoadWidget&&e.preLoadWidget.call(r,e),r.widgets[e.widgetKey]=n.$(e.selector),e.type){case"recommendations":return r.loadRecommendationsWidget(e,t);case"recently-viewed":return r.loadRecentlyViewedWidget(e,t);case"favorites":return r.loadFavoritesWidget(e,t);case"personalshopper-cta":return r.loadPersonalshopperCtaWidget(e,t)}else n.ebUtils.logError("No widgetKey provided for widget type "+e.type)},EarlyBirdsWidgets.prototype.fireWhenSelectorIsReady=function(e,t){var r=this,n=r.eb,i=function(e){return e.replace(/:[^,\s]*/g,"")};if(!e.selector&&e.location&&e.location.path){n.ebUtils.log("widget:fireWhenSelectorIsReady : selector is computed from location");var o="eb-"+n.ebUtils.guid(),a=function(){return n.$(e.location.path)[e.location.type]('<div id="'+o+'"></div>'),e.selector="#"+o,r.widgets[e.widgetKey]=n.$(e.selector),t()};n.ebUtils.fireWhenSelectorIsReady(i(e.location.path),a)}else e.selector?n.ebUtils.fireWhenSelectorIsReady(i(e.selector),t):n.ebUtils.log("Widget not fired because there was not an available selector")},EarlyBirdsWidgets.prototype.loadRecommendations=function(e,t,r,n){var i=this,o=i.eb;i.getCompiledTemplate(e.template,function(a,s){null!==a&&n(a);var l=s({recommendations:t,config:e,recommendationId:r});o.$(e.selector).html(l),i.mapHtmlRecommendationsToProducts(e.selector,t,r),i.bindClickOnReco(e.selector,e),i.turnRecommendationWidgetToInteractive(e,t),n()})},EarlyBirdsWidgets.prototype.loadRecommendationsWidget=function(e,t){var r=this,n=r.eb;n.ebUtils.log("loadRecommendationsWidget"),r.getRecommendations(e,function(i,o,a,s,l){return null!==i?n.ebUtils.logError(i):o.length?void("undefined"!=typeof s&&(e.widget=s,e.template&&"string"==typeof e.template&&(e.template={path:e.template}),!e.template&&s.template&&(e.template=s.template),s.location&&(e.location=s.location),a&&(e.metadata=a),e.preLoadRecommendations&&e.preLoadRecommendations.call(r,e),r.fireWhenSelectorIsReady(e,function(){var i=e.loadRecommendations?e.loadRecommendations:r.loadRecommendations;i.call(r,e,o,l,function(r){return r||n.ebUtils.dispatchEvent("eb-widget-loaded",{config:e,recommendations:o,metadata:a,widget:s}),"function"==typeof t?t(r,e,o,a,s):null!==r&&"undefined"!=typeof r?n.ebUtils.logError(r):void 0})}))):void(e.onRecommendationsEmpty&&e.onRecommendationsEmpty.call(r,e,o,a,s))})},EarlyBirdsWidgets.prototype.loadFavoritesWidget=function(e,t){var r=this,n=r.eb;n.ebUtils.log("loadFavoritesWidget"),r.getFavorites(e,function(i,o){return null!==i?n.ebUtils.logError(i):void r.getCompiledTemplate(e.template,function(i,a){if(null!==i)return n.ebUtils.logError(i);var s=a({favorites:o,config:e});r.fireWhenSelectorIsReady(e,function(){n.$(e.selector).html(s),r.mapHtmlToProducts(e.selector,o),r.bindClickOnReco(e.selector,e),r.bindRemoveFavoriteBtns(e),"function"==typeof t&&t(i,e,o)})})})},EarlyBirdsWidgets.prototype.loadRecentlyViewedWidget=function(e,t){var r=this,n=r.eb;n.ebUtils.log("loadRecentlyViewedWidget"),r.getRecentlyViewed(e,function(i,o){return null!==i?n.ebUtils.logError(i):void r.getCompiledTemplate(e.template,function(i,a){if(null!==i)return n.ebUtils.logError(i);var s=a({products:o,config:e});r.fireWhenSelectorIsReady(e,function(){n.$(e.selector).html(s),r.mapHtmlToProducts(e.selector,o),r.bindClickOnReco(e.selector,e),"function"==typeof t&&t(i,e,o)})})})},EarlyBirdsWidgets.prototype.loadPersonalshopperCtaWidget=function(e,t){var r=this,n=r.eb;n.ebUtils.log("loadPersonalshopperCtaWidget"),r.countFavorites(e,function(i,o){return null!==i?n.ebUtils.logError(i):void r.getCompiledTemplate(e.template,function(r,i){if(null!==r)return n.ebUtils.logError(r);var a=i({nbFavorites:o,config:e});n.$("body").append(a),"function"==typeof t&&t()})})},EarlyBirdsWidgets.prototype.getIdsToBan=function(e,t){var r=this,n=r.eb,i=n.config.apiHost+"/widget/"+e.widgetKey+"/idsToBan/"+e.profile;n.ebUtils.sendRequest("GET",i,n.ebUtils.parseErrorsThenCallback.bind(this,function(e,r){"undefined"!=typeof r.idsToBan?t(null,r.idsToBan):t(new Error("Banned ids could not be retrieved"))}))},EarlyBirdsWidgets.prototype.getFavorites=function(e,t){var r=this,n=r.eb,i=n.config.apiHost+"/widget/"+e.widgetKey+"/favorites/"+e.profile;n.ebUtils.sendRequest("GET",i,function(e,r){"undefined"!=typeof r.favorites?(Cookies.set("eb-nbfavorites-count",r.favorites.length),t(null,r.favorites)):t(new Error("Favorites could not be retrieved"))})},EarlyBirdsWidgets.prototype.getRecentlyViewed=function(e,t){var r=this,n=r.eb,i=n.config.apiHost+"/widget/"+e.widgetKey+"/products-by-verb/"+e.profile+"/view?howMany=10";n.ebUtils.sendRequest("GET",i,function(e,r){"undefined"!=typeof r.products?t(null,r.products):t(new Error("Products could not be retrieved"))})},EarlyBirdsWidgets.prototype.countFavorites=function(e,t){var r=this,n=r.eb,i=Cookies.get("eb-nbfavorites-count");if(i)t(null,i);else{var o=n.config.apiHost+"/widget/"+e.widgetKey+"/favorites/"+e.profile+"/count";n.ebUtils.sendRequest("GET",o,n.ebUtils.parseErrorsThenCallback.bind(this,function(e,r){"undefined"!=typeof r.count?(Cookies.set("eb-nbfavorites-count",r.count),t(null,r.count)):t(new Error("Favorites count could not be retrieved"))}))}},EarlyBirdsWidgets.prototype.getRecommendations=function(e,t){var r=this,n=r.eb;e.widgetId&&(e.widgetKey=e.widgetId,delete e.widgetId);var i=n.config.apiHost+"/widget/"+e.widgetKey+"/recommendations/"+(e.profile||"");e.sessionId&&(i=n.config.apiHost+"/widget/"+e.widgetKey+"/recommendations/sessionid/"+e.sessionId),e.customerid&&(i=n.config.apiHost+"/widget/"+e.widgetKey+"/recommendations/customerid/"+e.customerid),e.userId&&(i=n.config.apiHost+"/widget/"+e.widgetKey+"/recommendations/userid/"+e.userId),"undefined"!=typeof e.rescorerParams&&null!==e.rescorerParams&&e.rescorerParams!=={}&&(i+=(i.indexOf("?")>=0?"&":"?")+"rescorerParams="+encodeURIComponent(ebJSON.stringify(e.rescorerParams))),"undefined"!=typeof e.variables&&null!==e.variables&&e.variables!=={}&&("function"==typeof e.variables?e.variables=e.variables.apply(n):e.variables=n._.mapObject(e.variables,function(e,t){return"function"==typeof e?e.apply(n):e}),i+=(i.indexOf("?")>=0?"&":"?")+"variables="+encodeURIComponent(ebJSON.stringify(e.variables))),"undefined"!=typeof e.distribution&&null!==e.distribution&&e.distribution!==[]&&(i+=(i.indexOf("?")>=0?"&":"?")+"distribution="+encodeURIComponent(ebJSON.stringify(e.distribution))),"undefined"!=typeof e.howMany&&null!==e.howMany&&(i+=(i.indexOf("?")>=0?"&":"?")+"howMany="+parseInt(e.howMany)),"undefined"!=typeof e.page&&null!==e.page&&(i+=(i.indexOf("?")>=0?"&":"?")+"page="+parseInt(e.page)),"undefined"!=typeof e.offset&&null!==e.offset&&(i+=(i.indexOf("?")>=0?"&":"?")+"offset="+parseInt(e.offset)),"undefined"!=typeof e.fields&&null!==e.fields&&(i+=(i.indexOf("?")>=0?"&":"?")+"fields="+e.fields),"undefined"!=typeof e.completeWithMostPopularItems&&null!==e.completeWithMostPopularItems&&(i+=(i.indexOf("?")>=0?"&":"?")+"completeWithMostPopularItems="+e.completeWithMostPopularItems),"undefined"!=typeof e.distribIndexes&&null!==e.distribIndexes&&(i+=(i.indexOf("?")>=0?"&":"?")+"distribIndexes="+(Array.isArray(e.distribIndexes)?e.distribIndexes.join(","):e.distribIndexes)),"undefined"!=typeof e.store&&null!==e.store&&(i+=(i.indexOf("?")>=0?"&":"?")+"store="+e.store),"undefined"!=typeof e.locale&&null!==e.locale&&(i+=(i.indexOf("?")>=0?"&":"?")+"locale="+e.locale),"undefined"!=typeof e.metadata&&null!==e.metadata&&(i+=(i.indexOf("?")>=0?"&":"?")+"metadata="+e.metadata),/ebSkipAb=(0|false)/i.test(window.location.href)?Cookies.remove("eb-skip-ab"):/ebSkipAb/i.test(window.location.href)&&Cookies.set("eb-skip-ab",1),Cookies.get("eb-skip-ab")&&(i+=(i.indexOf("?")>=0?"&":"?")+"skipAb"),n.ebUtils.sendRequest("GET",i,n.ebUtils.parseErrorsThenCallback.bind(this,function(e,r){return e?t(e):void("undefined"!=typeof r.recommendations?(r.id&&(window.ebRecoIds=window.ebRecoIds||[],window.ebRecoIds.push(r.id)),t(null,r.recommendations,r.metadata,r.widget,r.id,r.pagination)):t(new Error("Recommendations could not be retrieved")))}))},EarlyBirdsWidgets.prototype.getHashCode=function(e){var t,r,n,i=0;if(0===e.length)return i;for(t=0,n=e.length;t<n;t++)r=e.charCodeAt(t),i=(i<<5)-i+r,i|=0;return i},EarlyBirdsWidgets.prototype.getCompiledTemplate=function(e,t){var r=this,n=r.eb,i=r.getHashCode(ebJSON.stringify(e));return r.compiledTemplate[i]?t(null,r.compiledTemplate[i]):void r.getTemplate(e,function(e,o){return null!==e?t(e):(r.compiledTemplate[i]=n._.template(o),void t(null,r.compiledTemplate[i]))})},EarlyBirdsWidgets.prototype.getTemplate=function(e,t){var r=this,n=r.eb,i=!1;e||(e={path:"//cdn.early-birds.io/tenants/generic/templates/recommendation.html"});var o=r.getHashCode(ebJSON.stringify(e));if(r.template[o])return t(null,r.template[o]);if("string"==typeof e&&(e={path:e}),e.path&&e.path.indexOf("//")>=0&&(i=e.path),i)n.ebUtils.sendRequest("GET",i,n.ebUtils.parseErrorsThenCallback.bind(this,function(e,n){return null!==e?t(e):(r.template[o]=n,void t(null,r.template[o]))}));else{if(e.ejs){var a=e.ejs;e.css&&(a+='<style type="text/css">'+e.css+"</style>"),r.template[o]=a}else e.path?r.template[o]=n.$(e.path).html():n.ebUtils.logError("No template found for this widget");t(null,r.template[o])}},EarlyBirdsWidgets.prototype.mapHtmlRecommendationsToProducts=function(e,t,r){var n=this,i=n.eb;if(i.$(e).is("[data-product-id]"))i.$(e).data("product",t[0]),i.$(e).data("recommendation-id",r);else for(var o=0;o<t.length;o++)i.$(e).find('.eb-recommendation[data-product-id="'+t[o].product._id.original_id+'"]').data("product",t[o]).data("recommendation-id",r)},EarlyBirdsWidgets.prototype.mapHtmlToProducts=function(e,t){var r=this,n=r.eb;if(n.$(e).is("[data-product-id]"))n.$(e).data("product",t[0]);else for(var i=0;i<t.length;i++)n.$(e).find('[data-product-id="'+t[i]._id.original_id+'"]').data("product",t[i])},EarlyBirdsWidgets.prototype.bindButtonsForMultipleRecommendations=function(e,t,r){for(var n=this,i=0;i<t.length;i++){var o=e.find('.eb-recommendation[data-product-id="'+t[i].product._id.original_id+'"]');n.bindButtons(o,r)}},EarlyBirdsWidgets.prototype.bindButtons=function(e,t){var r=this;r.bindLike(e,t),r.bindDislike(e,t),r.bindFavorite(e,t)},EarlyBirdsWidgets.prototype.bindClickOnReco=function(e,t){var r=this,n=r.eb;n.$(e).on("click",".eb-recommendation a:not(.eb-btn), .eb-favorite a:not(.eb-btn)",function(e){var i,o=n.$(this),a="_blank"===o.attr("target");a&&(i=window.open("")),o.hasClass("eb-stop-redirect")||o.hasClass("eb-redirect")||e.preventDefault();var s=o.attr("href"),l=o.parents(".eb-recommendation,.eb-favorite").data("product"),c=o.parents(".eb-recommendation,.eb-favorite").data("recommendation-id");l.product&&(l=l.product),n.ebQueue.push(["trackActivity",r.getActivityForProduct(l,"click-on-reco",t,c),function(){o.hasClass("eb-stop-redirect")||(a?i.location=s:document.location=s)}])})},EarlyBirdsWidgets.prototype.bindLike=function(e,t,r){var n=this,i=n.eb;e.on("click",".eb-btn-like",function(e){e.preventDefault();var o=i.$(this).parents(".eb-recommendation,.eb-favorite"),a=o.data("product");i.ebQueue.push(["trackActivity",n.getActivityForProduct(a.product,"like",t),function(){return r?r.call(n,o,a,t):void n.addFavorite(o,a,t,function(){n.newRecommendation(o,t)})}])})},EarlyBirdsWidgets.prototype.bindDislike=function(e,t,r){var n=this,i=n.eb;e.on("click",".eb-btn-unlike",function(e){e.preventDefault();var o=i.$(this).parents(".eb-recommendation,.eb-favorite"),a=o.data("product");i.ebQueue.push(["trackActivity",n.getActivityForProduct(a.product,"unlike",t),function(){return r?r():void n.newRecommendation(o,t)}])})},EarlyBirdsWidgets.prototype.bindFavorite=function(e,t,r){var n=this,i=n.eb;e.on("click",".eb-btn-favorite",function(e){e.preventDefault();var o=i.$(this).parents(".eb-recommendation,.eb-favorite"),a=o.data("product");n.addFavorite(o,a,t,function(){if(n.newRecommendation(o,t),r)return r()})})},EarlyBirdsWidgets.prototype.bindRemoveFavorite=function(e,t,r){var n=this,i=n.eb;e.on("click",".eb-btn-remove-favorite",function(e){e.preventDefault();var o=i.$(this).parents(".eb-favorite").attr("data-product-id");n.removeFavorite(o,t,r)})},EarlyBirdsWidgets.prototype.getActivityForProduct=function(e,t,r,n){var i,o=r&&r.widgetKey?r.widgetKey:null;return i={original_id:e._id.original_id,type:"product",verb:t},n&&(i.recommendationId=n),o&&(i.widget=o),i},EarlyBirdsWidgets.prototype.addFavorite=function(e,t,r,n){var i=this,o=i.eb;i.getCompiledTemplate(r.template,function(a,s){var l=s({favorites:[t.product],recommendations:[],config:r}),c=o.$(l).find(".eb-favorite:eq(0)");c.length>0&&(o.$(c).data("product",t.product),o.$(".eb-favorites-list").prepend(c));var u=parseInt(Cookies.get("eb-nbfavorites-count"))+1;o.$(".eb-favorites-count").html(u),Cookies.set("eb-nbfavorites-count",u),o.$("body").trigger("eb-favorite-added",[t.product,e]),n.call(i,t.product,e)})},EarlyBirdsWidgets.prototype.bindRemoveFavoriteBtns=function(e){var t=this,r=t.eb;t.widgets[e.widgetKey].on("click",".eb-btn-remove-favorite",function(n){n.preventDefault();var i=r.$(this).parents(".eb-favorite").attr("data-product-id");t.removeFavorite(i,e)})},EarlyBirdsWidgets.prototype.newRecommendation=function(e,t){var r=this,n=r.eb,i=n._.clone(t);"undefined"!=typeof i.rescorerParams&&null!==i.rescorerParams||(i.rescorerParams={}),i.distribution&&(i.preserveDistribution&&"undefined"!=typeof n.$(e).data("product").distribution&&(i=n._.extend(i,t.distribution[n.$(e).data("product").distribution])),delete i.distribution);var o=[];n.$(".eb-recommendation").each(function(){o.push(n.$(this).attr("data-product-id"))}),o=n._.uniq(o),i.rescorerParams.idsToBan?i.rescorerParams.idsToBan=n._.union(i.rescorerParams.idsToBan,o):i.rescorerParams.idsToBan=o,i.howMany=1;var a=n.$(e).data("product");void 0!==a.distribution&&(i.distribIndexes=a.distribution);var s=null,l=null,c=null,u=!1,d=function(){if(s&&c&&u){var o=c({recommendations:s,config:i}),a=n.$(o).find('.eb-recommendation[data-product-id="'+s[0].product._id.original_id+'"]');a.hide(),n.$(e).replaceWith(a),r.mapHtmlRecommendationsToProducts(a,s,l),r.bindButtons(a,i),a.fadeIn(400),n.ebUtils.dispatchEvent("eb-recommendation-added",{recommendations:s,config:i}),n.$("body").trigger("eb-recommendation-added",[a,t])}};n.$(e).fadeOut(400,function(){u=!0,d()}),r.getRecommendations(i,function(o,a,u,f,p){return s=a,l=p,o?n.ebUtils.logError(o):void(s.length>0?r.getCompiledTemplate(i.template,function(e,t){c=t,d()}):n.$("body").trigger("eb-recommendation-empty",[e,t]))})},EarlyBirdsWidgets.prototype.turnRecommendationWidgetToInteractive=function(e,t){var r=this,n=r.eb;r.widgets[e.widgetKey].find(".eb-btn-like,.eb-btn-unlike").length>0&&(r.bindButtonsForMultipleRecommendations(r.widgets[e.widgetKey],t,e),r.widgets[e.widgetKey].find(".eb-favorites-list").length>0&&r.getFavorites(e,function(t,i){i.length>0&&(r.bindRemoveFavoriteBtns(e),r.getCompiledTemplate(e.template,function(t,o){if(null!==t)return n.ebUtils.logError(t);var a=o({favorites:i,recommendations:[],config:e}),s=n.$(a).find(".eb-favorites-list");r.mapHtmlToProducts(s,i),r.widgets[e.widgetKey].find(".eb-favorites-list").replaceWith(s),r.widgets[e.widgetKey].find(".eb-favorites-count").html(i.length),r.widgets[e.widgetKey].trigger("eb-turned-to-interactive")}))}))},EarlyBirdsWidgets.prototype.removeFavorite=function(e,t,r){var n=this,i=n.eb;i.ebQueue.push(["deleteFavorite",e,function(){var t=parseInt(Cookies.get("eb-nbfavorites-count"))-1;if(Cookies.set("eb-nbfavorites-count",t>0?t:0),i.$('.eb-favorites .eb-favorite[data-product-id="'+e+'"]').remove(),i.$(".eb-favorites-count").html(t),i.$("body").trigger("eb-favorite-removed"),"undefined"!=typeof r)return r()}])};var HTTP_PROTOCOL="https:"==document.location.protocol?"https://":"http://",EarlyBirds=function(){var e=this;e._=_.noConflict(),e.ebUtils=new EarlyBirdsUtils(e);var t=window._ebq;window._ebq=e.ebQueue=new EarlyBirdsQueue(e);var r=!1;e.profile=e.getProfile(),"undefined"!=typeof EarlyBirdsWidgets&&(e.ebWidgets=new EarlyBirdsWidgets(e)),window._ebq.push.apply(window._ebq,t),e.loadScripts(function(){e.ebWidgets&&(e.ebUtils.log("ebWidgets is loaded with jQuery. Noconflict : "+r),e.ebUtils.fireWhenConditionTrue(function(){return window.jQuery&&"function"==typeof window.jQuery},100,function(){e.$=window.jQuery}),window._ebq.push.apply(e.ebQueue,e.scriptsQueue))})};if(EarlyBirds.prototype={trackerKey:"",ebUtils:null,ebWidgets:null,ebQueue:null,profile:null,clusterIndexBase:0,initRequested:!1,initedQueue:[],identifiedRequested:!1,identifiedQueue:[],scriptsQueue:[],scripts:[],cookieConfig:{expires:365},$:null,config:{apiHost:HTTP_PROTOCOL+("undefined"!=typeof Cookies&&Cookies.get("eb-preprod")?"preprod-":"")+(10*Math.random()%10>5?"api.early-birds.fr":("undefined"!=typeof Cookies&&Cookies.get("eb-preprod"),"api.early-birds.fr")),trackingEndpoint:"tracker"}},EarlyBirds.prototype.getProfile=function(){var e=new Date,t={id:null,hash:null,lashUpdate:null,deprecated:!0},r=Cookies.get("eb-profile");return r?(r=r.split(":"),t={id:r[0],hash:r[1],lastUpdate:r[2],deprecated:!1},isNaN(t.lastUpdate)?t.deprecated=!0:(!t.lastUpdate||e.getTime()-t.lastUpdate>36e5)&&(t.deprecated=!0),t):t},EarlyBirds.prototype.setProfile=function(e){return Cookies.set("eb-profile",e.id+":"+e.hash+":"+e.lastUpdate,this.cookieConfig),this.profile=e,this.profile},EarlyBirds.prototype.debug=!1,EarlyBirds.prototype.loadWidgets=!0,EarlyBirds.prototype.init=function(e){var t=this;return!t.initRequested&&(t.ebUtils.log("Init trackerKey"),void(e?(t.trackerKey=e,t.initRequested=!0,window._ebq.push.apply(t.ebQueue,t.initedQueue)):t.ebUtils.log("Tracker inited without trackerKey")))},EarlyBirds.prototype.loadScripts=function(e){var t=this;t.ebUtils.log("load scripts");var r=function(e,t){var r=document.createElement("script");r.src=e,r.onload=r.onreadystatechange=function(){r.onreadystatechange=r.onload=null,t()};var n=document.getElementsByTagName("head")[0];(n||document.body).appendChild(r)};!function(){0!==t.scripts.length?r(t.scripts.shift(),arguments.callee):e()}()},EarlyBirds.prototype.trackActivity=function(e,t){var r=this;r.ebUtils.log("trackActivity"),this.waitUntilIdentified("trackActivity",e,function(){e instanceof Array||(e=[e]);var n=r.ebUtils.hashCode(ebJSON.stringify(e)),i=Cookies.get("eb-lastactivity-hash"),o={};if(i&&n.toString()===i)r.ebUtils.log("trackActivity not fired because this activity has already been tracked"),"function"==typeof t&&t();else{var a=!1,s=null;if(e.forEach(function(e,t){e.profile=r.profile.id,e.callback&&(s=r.ebUtils.clone(e.callback),delete e.callback),e.object&&e.object.original_id&&(e.original_id=e.object.original_id,delete e.object.original_id),e.object&&e.object.type&&(e.type=e.object.type,delete e.object.type),e.object&&e.object.price&&(e.price=e.object.price,delete e.object.price),e.object&&e.object.quantity&&(e.quantity=e.object.quantity,delete e.object.quantity),e.type||(e.type="product"),e.original_id||e.originalId||(a=!0),e.segments&&(o=r._.extend(o,e.segments),delete e.segments)}),a)return r.ebUtils.log("Activities not sent because one of its doesn't have an original_id"),r.ebUtils.log(e),!1;if(e.length<=0)return void r.ebUtils.log("trackActivity need at least one activity to track");o=r._.extend(o,r.ebUtils.getNavigatorSegments()),r.ebUtils.sendRequest("POST",r.config.apiHost+"/"+r.config.trackingEndpoint+"/"+r.trackerKey+"/activity",{activity:e,segments:o},r.ebUtils.parseErrorsThenCallback.bind(this,function(e,i){if("function"==typeof t&&t(),Cookies.set("eb-lastactivity-hash",n,{expires:r.cookieConfig.expires}),i){if(i.activities&&r.ebUtils.log("trackActivity ok : "+i.activities.map(function(e){return e._id}).join(",")),r.clusterIndexBase>0)for(var o in i.profile.clusters)for(var a in i.profile.clusters[o])i.profile.clusters[o][a]=parseInt(i.profile.clusters[o][a])+r.clusterIndexBase;if(i.profile&&i.profile.clusters){var l=Object.keys(i.profile.clusters);if(l&&l[0]){var c=i.profile.clusters[l[0]],u=Object.keys(c);c&&u&&u[0]&&Cookies.set("eb-profile-cluster",c[u[u.length-1]],{expires:r.cookieConfig.expires})}Cookies.set("eb-profile-clusters",JSON.stringify(i.profile.clusters),{expires:r.cookieConfig.expires})}}null!==s&&s.call(r,i)}))}})},EarlyBirds.prototype.trackInterest=function(e,t){var r=this;r.ebUtils.log("trackInterest"),this.waitUntilIdentified("trackInterest",e,function(){return e instanceof Array||(e=[e]),e.forEach(function(e){e.profile=r.profile.id,"function"==typeof e.tags?e.tags=e.tags.apply(r):e.tags=r._.map(e.tags,function(e){return"function"==typeof e?e.apply(r):e})}),e.length<=0?void r.ebUtils.log("trackInterest need at least one interest to track"):void r.ebUtils.sendRequest("POST",r.config.apiHost+"/"+r.config.trackingEndpoint+"/"+r.trackerKey+"/interest",{interest:e},r.ebUtils.parseErrorsThenCallback.bind(this,function(e,n){n&&n.interests&&r.ebUtils.log("trackInterest ok : "+n.interests.map(function(e){return e._id}).join(",")),"function"==typeof t&&t()}))})},EarlyBirds.prototype.deleteFavorite=function(e,t){var r=this;if(r.ebUtils.log("deleteFavorite"),r.trackerKey&&e)if(r.profile.id){var n={profile:r.profile.id,original_id:e,verb:"like",opposite:!0};r.ebUtils.sendRequest("POST",r.config.apiHost+"/"+r.config.trackingEndpoint+"/"+r.trackerKey+"/activity",{activity:n},r.ebUtils.parseErrorsThenCallback.bind(this,function(e,n){"function"==typeof t&&t(),Cookies.set("eb-lastactivity-hash",hash,{expires:r.cookieConfig.expires}),n&&n.activities&&r.ebUtils.log("trackActivity ok : "+n.activities.map(function(e){return e._id}).join(","))}))}else r.identifiedQueue.push(["deleteFavorite",e]);else r.initedQueue.push(["deleteFavorite",e])},EarlyBirds.prototype.identify=function(e){var t=this,r=null;if(t.ebUtils.dispatchEvent("eb-identify-initiated",e),t.identifiedRequested)return!1;if(e.callback&&(r=t.ebUtils.clone(e.callback),delete e.callback),e=e||{},!t.trackerKey)return t.initedQueue.push(["identify",e]);t.identifiedRequested=!0;var n=t.ebUtils.hashCode(ebJSON.stringify(e)),i=function(e,n){return null!==r&&r.call(t,e,n),window._ebq.push.apply(t.ebQueue,t.identifiedQueue)};if(t.profile.id&&!t.profile.deprecated&&n==t.profile.hash)return t.ebUtils.log("Cookie profile found "+t.profile.id+", identical hash and not deprecated, no request"),t.ebUtils.dispatchEvent("eb-profile-done",t.profile.id),i(t.profile);if(t.profile.id?(e.id=t.profile.id,t.ebUtils.log("Cookie profile found but new hash is different or is deprecated, update the profile")):t.ebUtils.log("No cookie found"),e.datasources){var o=[];e.datasources.forEach(function(e,t){"0"!=e.original_id&&""!=e.original_id&&o.push(e)}),e.datasources=o}var a=t.config.apiHost+"/"+t.config.trackingEndpoint+"/"+t.trackerKey+"/identify";t.ebUtils.sendRequest("POST",a,{profile:e},t.ebUtils.parseErrorsThenCallback.bind(this,function(e,r){if(!e&&r&&r.profile){t.ebUtils.log("Identify ok "+r.profile.id),
r.cookie&&(r.cookie.expires&&parseInt(r.cookie.expires)>3600&&(t.cookieConfig.expires=parseInt(parseInt(r.cookie.expires)/3600/24)),r.cookie.domain&&document.location.hostname.indexOf(r.cookie.domain)>=0&&(t.cookieConfig.domain=r.cookie.domain));var o=new Date;t.setProfile({id:r.profile.id,hash:n,lastUpdate:o.getTime(),deprecated:!1}),t.ebUtils.dispatchEvent("eb-profile-done",r.profile.id);var a=t.ebUtils.clone(t.profile);return a.profile=r.profile,i(a,r)}}))},EarlyBirds.prototype.loadWidget=function(e){var t=this;(this.loadWidgets||e.forceLoad)&&(t.ebUtils.log("loadWidget"),this.waitUntilScriptsLoaded("loadWidget",e,function(){var r=t.ebUtils.getParamByName("eb-profile-id");""===r?(e.profile=t.profile.id,e.owner=!0):(e.profile=r,e.owner=!1),t.ebWidgets.loadWidget(e)}))},EarlyBirds.prototype.execute=function(e){var t=this;t.ebUtils.log("execute"),this.waitUntilScriptsLoaded("execute",e,function(){e.profile=t.profile.id,e.onload.call(t,e)})},EarlyBirds.prototype.waitUntilScriptsLoaded=function(e,t,r){var n=this;this.waitUntilIdentified(e,t,function(){return null!==n.$?r():(n.ebUtils.log("execute passed in scriptsQueue"),void n.scriptsQueue.push([e,t]))})},EarlyBirds.prototype.waitUntilIdentified=function(e,t,r){var n=this;this.waitUntilQueueInited(e,t,function(){return null!==n.profile.id?r():(n.ebUtils.log("execute passed in identifiedQueue"),void n.identifiedQueue.push([e,t]))})},EarlyBirds.prototype.waitUntilQueueInited=function(e,t,r){var n=this;return n.trackerKey?r():(n.ebUtils.log("execute passed in initedQueue"),void n.initedQueue.push([e,t]))},EarlyBirds.prototype.getProfileClusters=function(){var e=Cookies.get("eb-profile-clusters");return e?JSON.parse(e):null},EarlyBirds.prototype.getDefaultPredictorProfileClusters=function(){var e=this.getProfileClusters();if(e){var t=Object.keys(e);if(t&&t[0])return e[t[0]]}return null},EarlyBirds.prototype.getProfileClusterByGenerationId=function(e,t){var r=this.getProfileClusters();return r&&r[e]&&r[e][t]?r[e][t]:null},EarlyBirds.prototype.getDefaultPredictorProfileClusterByGenerationId=function(e){var t=this.getDefaultPredictorProfileClusters();return t&&t[e]?t[e]:null},!EarlyBirdsUtils.isIE8()){var eb=new EarlyBirds;"undefined"==typeof window.eb&&(window.eb=eb)}!function(e){e.eb.vars={trackerKey:"578f8652fab5432140d33cce",datasourceId:"578f8652fab5432140d33cd2",subtitle:"Ces recommandations personnalisées sont inspirées de votre historique de produits consultés et de vos achats.",widgets:{ficheArticle:"5798d93f0c21a16b53719755",strateAccessoires:"591aaedbe054e157512b08d6",strateCartouches:"595e49d83f5ec42e21ce200b",ficheArticleMobile:"57f36ddcc20fb5245a5397fd",homeUniversBricolage:"58823ada0afe4420f2ee9334",homeUniversEnfants:"5882377fe04f8f20f89b9459",homeUniversFilms:"588234330afe4420f2ee92e4",homeUniversInformatique:"5798d98ca723607a53f03635",homeUniversJeuxVideos:"588234150afe4420f2ee92e0",homeUniversLivre:"5798d97b2f6d5c6c53c7fbd4",homeUniversEbook:"59a579195fc02366f2f69ad8",homeUniversMaison:"588239b1a0fffc20ec084deb",homeUniversMusique:"58823362a0fffc20ec084d96",homeUniversPhoto:"588238ba0d814320fee41581",homeUniversSmartphones:"588238260afe4420f2ee9304",homeUniversSon:"588239040d814320fee4158c",homeUniversSport:"58823b1fa0fffc20ec084dfe",homeUniversTele:"5882393b0d814320fee41591",homepage:"5798d9320c21a16b53719754",page404:"588244340d814320fee415c0",pageRecherche:"588244240afe4420f2ee935f",pageListe:"58824075a0fffc20ec084e1a",panierFlottant:"5798d955aee0c88053cebafd",panierFlottantMobile:"58a2e44b5e022a56bd843c91",panierRecapitulatif:"5798d99d0c21a16b53719757",blackFriday:"5a14302bfbe45238a337be74"},homesUnivers:{Bricolage:"",Enfants:"Enfants,_jouets",Films:"DVD_&_Vidéo",Informatique:"Informatique",JeuxVideos:"Jeux_vidéo",Livre:"Livre",Ebook:"Livres_numériques,_ebook",Maison:"Maison,_Electroménager",Musique:"Musique",Photo:"Photo,_caméscope",Smartphones:"Smartphones_et_Objets_Connectés",Son:"Son,_hifi,_lecteur_MP3",Sport:"Sport_loisirs_santé",Tele:"TV,_Vidéo,_Home_cinema"}}}(window),function(e){var t={profileId:null,navigationStart:0,jsLoaded:Date.now(),jQueryLoaded:0,jQueryReady:0,underscoreReady:0,ebResponseTime:0,ebNumResults:0,fnacResponseTime:0,fnacNumResults:0,version:2};e.eb.config.trackingEndpoint="events",e.eb.ebUtils.fireWhenConditionTrue(function(){return"undefined"!=typeof tc_vars&&"function"==typeof e.eb.$},20,function(){var r=!0;window.performance&&window.performance.timing&&window.performance.timing.navigationStart||(r=!1),r&&(t.navigationStart=window.performance.timing.navigationStart,t.jQueryLoaded=Date.now()),e.eb.populateFromEulerian=function(t){e.eb.ebUtils.log(t)};var n=!e.Fnac.config.isMobile,i=e.tc_vars;e.Fnac.config.isMobile&&"578f8652fab5432140d33cce"===e.eb.vars.trackerKey&&(i=e.tc_vars,e.eb.ebUtils.log("Using tc_vars beacause tc_vars is empty")),e._ebq=e._ebq||[],e._ebq.push(["init",e.eb.vars.trackerKey]);var o={info:{},callback:function(){e.eb.ebUtils.fireWhenConditionTrue(function(){return e.eb.$.isReady},20,function(){e.eb.$("body").trigger("eb-identify-loaded"),r=!(parseInt(window.eb.profile.id.replace("-",""),16)%100)})}};""!==i.user_id&&"1"===i.user_id.substring(0,1)&&(o.datasources=[{id:e.eb.vars.datasourceId,original_id:i.user_id.substring(1).toUpperCase()}]),""!==i.user_segment&&(o.info.segment=i.user_segment),""!==i.user_age&&(o.info.age=i.user_age),""!==i.user_gender&&(o.info.gender=i.user_gender),e._ebq.push(["identify",o]),e.eb.ebUtils.fireWhenConditionTrue(function(){return e.eb.$.isReady},20,function(){if(r&&(t.jQueryReady=Date.now()),n?(e.eb.$("div.f-productPage").length>0&&(e._ebq.push(["trackActivity",{originalId:i.product_ref_id,verb:"view"}]),e.eb.$("body").on("mousedown",'.Sticky-list a, a[href="#specifications"]',function(){e._ebq.push(["trackActivity",{originalId:i.product_ref_id,verb:"read-more"}])}),e.eb.$("body").on("mousedown","button.js-articleNewReview",function(){var t=e.eb.$("#txtStars").val();e._ebq.push(["trackActivity",{originalId:i.product_ref_id,verb:"add-rate-"+t}])})),e.eb.$("body").on("mousedown",".js-ProductBuy-add",function(){var t,r=this;e.eb.ebUtils.fireWhenSelectorIsReady(".js-ProductBuy-data",function(){for(var n=e.eb.$(".BasketPopin-product").attr("data-productid"),i=JSON.parse(e.eb.$(".js-ProductBuy-data").html()),o="",a=0;a<i.length;a++)n==i[a].Prid&&(o=i[a].Referentiel+"-"+i[a].Prid);if(e.eb.$("div.f-productPage").length>0&&e.eb.$("strong.product-price").length>0){var s=e.eb.$("strong.product-price").first().text().trim(),l=100*parseInt(s.substr(0,s.indexOf("€"))),c=parseInt(s.substr(s.indexOf("€")+1)||0);t=l+c}else t=e.eb.$(r).siblings(".thumbnail-priceBloc").length>0?e.eb.$(r).siblings(".thumbnail-priceBloc").find(".thumbnail-price").text().trim().replace("€",""):e.eb.$(r).parents(".Article-price").first().find(".userPrice").first().text().trim().replace("€","");var u={originalId:o,verb:"add-to-cart"};t&&"string"==typeof t&&(u.pprice=t.replace(/\D/g,"")),e._ebq.push(["trackActivity",u])},20)}),e.eb.$("body").on("mousedown",".eb-recommendation .js-ProductBuy-addInline",function(){var t=e.eb.$(this).parents(".eb-recommendation"),r=t.data("product-id"),n=t.data("recommendation-id"),i=t.find(".thumbnail-price").text().replace(/\D/g,""),o={originalId:r,price:i,verb:"click-on-reco",recommendationId:n,widget:e.eb.vars.widgets.panierFlottant};e._ebq.push(["trackActivity",o]);var o={originalId:r,price:i,verb:"add-to-cart"};e._ebq.push(["trackActivity",o])})):(e.eb.$("div.FA").length>0&&e._ebq.push(["trackActivity",{originalId:i.product_ref_id,verb:"view"}]),e.eb.ebUtils.fireWhenSelectorIsReady("#popinArticleJustAdded",function(){var t=i.product_ref_id,r=i.product_unitprice_ati;e._ebq.push(["trackActivity",{originalId:t,price:parseInt(100*parseFloat(r)),verb:"add-to-cart"}])}),e.eb.$("body").on("mousedown",".js-ProductBuy-add,a.button-Basket",function(){var t=i.product_ref_id,r=i.product_unitprice_ati;e._ebq.push(["trackActivity",{originalId:t,price:parseInt(100*parseFloat(r)),verb:"add-to-cart"}])}),e.eb.$("body").on("mousedown",".eb-recommendation button.js-AddAndTrackProductThumbnailBasket",function(){var t=e.eb.$(this).parents(".eb-recommendation"),r=t.attr("data-product-id"),n=t.data("recommendation-id"),i=e.eb.$(this).parents(".eb-recommendations").attr("data-widget-id"),o=t.find(".thumbnail-price").first().text().trim(),a=100*parseInt(o.substr(0,o.indexOf("€"))),s=parseInt(o.substr(o.indexOf("€")+1)||0);pprice=a+s,e._ebq.push(["trackActivity",{originalId:r,verb:"click-on-reco",recommendationId:n,widget:i}]),e._ebq.push(["trackActivity",{originalId:r,price:pprice,verb:"add-to-cart"}])}),e.eb.$("body").on("click",".eb-recommendation",function(){var t=e.eb.$(this).attr("data-product-id"),r=e.eb.$(this).data("recommendation-id"),n=e.eb.$(this).parents(".eb-recommendations").attr("data-widget-id");e._ebq.push(["trackActivity",{originalId:t,verb:"click-on-reco",recommendationId:r,widget:n}])})),document.location.href.indexOf("bfa=1")>-1&&document.location.href.indexOf("ebtest=1")>-1){e.eb.$("body").on("mousedown",".eb-recommendation",function(){var t=e.eb.$(this).data("recommendation-id"),r=e.eb.$(this).attr("data-product-id"),n=e.eb.$(this).parents(".eb-recommendations").attr("data-widget-id");e._ebq.push(["trackActivity",{originalId:r,verb:"click-on-reco",widget:n,recommendationId:t}])});var o=function(){var t=e.eb.$(this).parents(".eb-recommendation").attr("data-product-id"),r=e.eb.$(this).parents(".eb-recommendations").attr("data-widget-id");e._ebq.push(["trackActivity",{originalId:t,verb:"add-to-cart",widget:r}])},a=function(){var t=e.eb.$(this).parents("article").attr("data-product-id"),r=e.eb.$(this).parents("article").attr("data-catalog-id"),n=r+"-"+t;e._ebq.push(["trackActivity",{originalId:n,verb:"add-to-cart"}])};e.eb.$("body").on("mousedown","div:not(.eb-recommendation)>article .js-ProductBuy-add",a),e.eb.$("body").on("mousedown",".eb-recommendation>article .js-ProductBuy-add",o),e.eb.$("body").on("mousedown",".eb-recommendation button:not(js-ProductBuy-add)",o)}location.href.indexOf("pop/merci")!==-1&&e.eb.ebUtils.fireWhenConditionTrue(function(){return"undefined"!=typeof i&&"undefined"!=typeof i.order_products},100,function(){for(var t=[],r=0;r<i.order_products.length;r++){i.order_products[r];t.push({originalId:i.order_products[r][3],price:parseFloat(i.order_products[r][5]).toFixed(2).toString().replace(".",""),quantity:i.order_products[r][4],verb:"buy",orderId:i.order_id})}e._ebq.push(["trackActivity",t])}),e.eb.ebUtils.fireWhenConditionTrue(function(){return"undefined"!=typeof _},20,function(){r&&(t.underscoreReady=Date.now());var o=function(){if(i.user_first_name)return i.user_first_name+", ";var t=e.eb.$(".Header__tabs-firstname");return t.length>0?e.eb.$(".Header__tabs-firstname").text().trim()+", ":""},a=function(n,i,a,s){var l=[],c=[],u=this,d=(this.eb,e.eb.$(n.selector));r&&(e.eb.profile&&e.eb.profile.id&&(t.profileId=e.eb.profile.id),t.ebResponseTime=Date.now(),t.ebNumResults=i.length),i.forEach(function(e){e.strategy.indexOf("hooklogic")>=0&&c.push(e),l.push(e.id)}),localStorage&&localStorage.setItem("alreadyRecommendedIds",JSON.stringify(l.slice(0,5))),n.url||(n.url="/api/navigation/rest/v1/thumbnail/suggestions/category"),n.url+="?references="+l.join("&references="),n.mobileParam&&(n.url+="&mobile=1"),n.trackingParam&&(n.url+="&trackingzone="+n.trackingParam);var f=e.eb.$("meta[name=pathname]").attr("content");f&&(n.url=f+n.url),e.eb.$.get(n.url,function(f){e.eb.ebUtils.fireWhenConditionTrue(function(){return"undefined"!=typeof Fnac&&"undefined"!=typeof Fnac.Views},100,function(){var p=f.substr(0,f.indexOf("\n"));f=f.split(p);var b=e.eb.$(n.outsideTemplate);r&&(t.fnacNumResults=f.length,t.fnacResponseTime=Date.now());var g=e.eb.$.map(f,function(t,r){return""!==t.trim()&&i[r-1]?e.eb.$(t).addClass("eb-recommendation").attr("data-product-id",i[r-1].id):null});e.eb.$(b).find(".eb-recommendations").html(g),d.html(b),n.widget.title&&d.find(".eb-title").html(n.widget.title.replace("#firstname#",o())),d.find(".eb-subtitle span").html(e.eb.vars.subtitle),d.attr("data-products",JSON.stringify(l)),d.find(".eb-recommendations").attr("data-widget-id",n.widgetKey),d.find(".js-ProductBuy-add,.showWishlist").addClass("eb-stop-redirect"),u.mapHtmlRecommendationsToProducts(n.selector,i,a),u.bindClickOnReco(n.selector,n),c.length>0&&c.forEach(function(t){var r=t.id.split("-")[1];d.find("article[data-product-id="+r+"]").after('<span class="thumbnail-sponsor">sponsorisé</span>'),d.on("click","article[data-product-id="+r+"]",function(){e.eb.$.get(t.product.click_url,function(){})}),d.find("article[data-product-id="+r+"]").attr("data-categoryname","PFreco|PFhooklogic"),d.find("article[data-product-id="+r+"] button[data-trackingbannerinfo]").each(function(t,r){e.eb.$(r).attr("data-trackingbannerinfo",e.eb.$(r).attr("data-trackingbannerinfo").replace("|PF|","|PFhooklogic|"))}),d.find("article[data-product-id="+r+"] a").each(function(t,r){e.eb.$(r).attr("href",e.eb.$(r).attr("href").replace("|PF|","|PFhooklogic|"))})});var v=d.find(".js-ProductThumbnail");v.length&&e.eb.ebUtils.fireWhenConditionTrue(function(){return"undefined"!=typeof Fnac.Views.ProductThumbnailView},100,function(){_.forEach(v,function(e){new Fnac.Views.ProductThumbnailView({el:e})})});var h=d.find(".js-Carousel");h.length&&e.eb.ebUtils.fireWhenConditionTrue(function(){return"undefined"!=typeof Fnac.Views.CarouselView},100,function(){new Fnac.Views.CarouselView({el:d}),Fnac.Views.CarouselView.onViewportUpdate()});var m=d.find(".js-ProductBuy");m.length&&e.eb.ebUtils.fireWhenConditionTrue(function(){return"undefined"!=typeof Fnac.Views.ProductBuyView},100,function(){_.forEach(m,function(e){new Fnac.Views.ProductBuyView({el:e})})}),n.postLoadWidget&&n.postLoadWidget(),s()})})},s=function(e){var t=this,r=t.eb.ebUtils;e.variables||(e.variables={}),localStorage&&localStorage.getItem("alreadyRecommendedIds")&&(e.variables.$alreadyRecommendedIds=JSON.parse(localStorage.getItem("alreadyRecommendedIds")));var n={replacement:"-",lower:!0};!e.variables.$productId&&i.product_ref_id&&(e.variables.$productId=i.product_ref_id),i.arbo_niv1&&":"!==i.arbo_niv1.substr(0,1)&&(e.variables.$cat1="CAT1_"+r.slug(i.arbo_niv1,n)),i.arbo_niv2&&":"!==i.arbo_niv2.substr(0,1)&&(e.variables.$cat2="CAT2_"+r.slug(i.arbo_niv2,n)),i.arbo_niv3&&":"!==i.arbo_niv3.substr(0,1)&&(e.variables.$cat3="CAT3_"+r.slug(i.arbo_niv3,n)),window.newCart&&(e.variables.$isNewCart=window.newCart)},l={"default":'            <div class="TinyClues-header">                <h2 class="TinyClues-title eb-title">Et si vous craquiez aussi pour... </h2>            </div>            <div class="Carousel js-Carousel js-Reco recos-25">                <style>.recos-25 .Carousel-item { width: 25%!important; }</style>                <div class="Carousel-overflowContainer Carousel-overflowContainer--noMargin">                    <div class="Carousel-container js-Carousel-container js-Recos eb-recommendations" style="left: 0%;" /></div>                </div>            </div>',coverflowHome:'            <section class="strate suggestion--product Carousel--outsideNav">                <div class="clearfix Strate-top">                        <h2 class="Strate-title eb-title">Ces produits vous ressemblent...</h2>                        <h2 class="Strate-title eb-subtitle"><span>Ces recommandations personnalisées sont inspirées de votre historique de produits consultés et de vos achats.</span></h2>                </div>                <div class="suggest-content Thumb-slide">                    <div class="Carousel js-Carousel js-Reco">                        <div class="Carousel-overflowContainer Carousel-overflowContainer--noMargin">                            <div class="Carousel-container js-Carousel-container js-Recos eb-recommendations simpleCarousel" style="left: 0%;" /></div>                            <button class="Carousel-arrow Carousel-arrow--left js-Carousel-previous"><i class="icon icon_i_057_arrow_left_01"></i></button>                            <button class="Carousel-arrow Carousel-arrow--right js-Carousel-next"><i class="icon icon_i_055_arrow_right_01"></i></button>                        </div>                    </div>                </div>            </div>',coverflowHeader:'            <section class="strate js-strate--Fnac js-strate--MP Carousel--outsideNav isActive">                <div class="productStrateTop">                    <h2 class="FAstrate-title">                        <span class="FAstrate-title-color js-ProductSticky-title eb-title">Les internautes ont aussi acheté</span>                    </h2>                </div>                <div class="similarContent Carousel js-Carousel">                    <div class="Carousel-overflowContainer Carousel-overflowContainer--noMargin">                        <div class="Carousel-container js-Carousel-container js-Recos eb-recommendations" style="left: 0%;" /></div>                        <button class="Carousel-arrow Carousel-arrow--left js-Carousel-previous"><i class="icon icon_i_057_arrow_left_01"></i></button>                        <button class="Carousel-arrow Carousel-arrow--right js-Carousel-next"><i class="icon icon_i_055_arrow_right_01"></i></button>                    </div>                </div>            </div>',headerMobile:'            <section class="FA-reco container js-accordion js-pasteOnTop open">                <h2 class="js-accordion-title open eb-title" style="background-color:#FFF;">VOUS POURRIEZ AUSSI AIMER</h2>                <div class="js-accordion-content IncludedAccessories open">                    <div class="container">                        <div class="owl-tpl-1 eb-recommendations">                        </div>                    </div>                </div>            </section>',headerPanierFlottantMobile:'<div><div class="eb-recommendations"></div></div>'},c=function(t){var r={type:"recommendations",trackingParam:i.page_name,fields:"id,recommendations(id,strategy,product(_id,click_url)),widget",loadRecommendations:a,outsideTemplate:l["default"],preLoadWidget:s,trackingParam:i.page_name,url:"/api/navigation/rest/v1/thumbnail/suggestions/category"};_.defaults(t,r),e._ebq.push(["loadWidget",t])};if(e.eb.vars.widgets.blackFriday&&document.location.href.indexOf("soldes/w-4")>=0&&c({widgetKey:e.eb.vars.widgets.blackFriday,outsideTemplate:l.coverflowHome,trackingParam:n?"joursUniques":"Black Friday",mobileParam:!n}),e.eb.vars.widgets.blackFriday&&document.location.href.indexOf("fnac.com/saintvalentin")>=0&&c({widgetKey:e.eb.vars.widgets.blackFriday,outsideTemplate:l.coverflowHome,trackingParam:"saintvalentin",mobileParam:!n}),e.eb.vars.widgets.ficheArticle&&i.page_name.indexOf("Fiche Article")>=0&&n&&(c({widgetKey:e.eb.vars.widgets.ficheArticle,outsideTemplate:l.coverflowHeader,howMany:12}),c({widgetKey:e.eb.vars.widgets.strateAccessoires,outsideTemplate:l.coverflowHeader,postLoadWidget:function(){e.eb.$(".strate.list.derivedProducts").remove()}}),c({widgetKey:e.eb.vars.widgets.strateCartouches,outsideTemplate:l.coverflowHeader})),e.eb.vars.widgets.ficheArticleMobile&&i.page_name.indexOf("Fiche Article")>=0&&!n&&c({widgetKey:e.eb.vars.widgets.ficheArticleMobile,outsideTemplate:l.headerMobile,mobileParam:!0,postLoadWidget:function(){e.eb.$(".FA-reco .js-accordion-content .container .eb-recommendations").owlCarousel({items:2})},howMany:12}),_.forEach(e.eb.vars.homesUnivers,function(t,r){var o=i.arbo_niv1.replace(new RegExp(" ","g"),"_");t&&e.eb.vars.widgets["homeUnivers"+r]&&o===t&&""===i.arbo_niv2&&i.page_name.indexOf("Web mobile FA")<0&&c({widgetKey:e.eb.vars.widgets["homeUnivers"+r],outsideTemplate:l.coverflowHome,trackingParam:i.page_name,mobileParam:!n,howMany:12})}),!e.eb.vars.widgets.homepage||"Home_Accueil"!==i.page_name&&"Accueil"!==i.arbo_niv1||c({widgetKey:e.eb.vars.widgets.homepage,outsideTemplate:l.coverflowHome,trackingParam:"Home Géné",mobileParam:!n,howMany:12}),e.eb.vars.widgets.panierFlottant&&n&&e.eb.$("body").on("mousedown",".js-ProductBuy-add",function(){e.eb.ebUtils.fireWhenSelectorIsReady(".BasketPopin-product",function(){for(var t=e.eb.$(".BasketPopin-product").attr("data-productid"),r=JSON.parse(e.eb.$(".js-ProductBuy-data").html()),n="",i=0;i<r.length;i++)t==r[i].Prid&&(n=r[i].Referentiel+"-"+r[i].Prid);c({widgetKey:e.eb.vars.widgets.panierFlottant,variables:{$productId:n},url:"/api/navigation/rest/v1/thumbnail/suggestions/basket"})})}),e.eb.vars.widgets.panierFlottantMobile&&!n&&e.eb.$("body").on("click",".js-ProductBuy-add",function(){e.eb.ebUtils.fireWhenSelectorIsReady(".js-basketModal",function(){e.eb.ebUtils.fireWhenConditionTrue(function(){return e.eb.$(".js-basketModal").hasClass("f-anim-slideBottom--done")},200,function(){var t=document.querySelector(".js-basketModal .js-recoPartners").dataset.productId;c({widgetKey:e.eb.vars.widgets.panierFlottantMobile,outsideTemplate:l.headerPanierFlottantMobile,postLoadWidget:function(){instantiateService.youMayAlsoLike()},variables:{$productId:t},url:"/api/navigation/rest/v1/thumbnail/suggestions/basket",howMany:4})})})}),e.eb.vars.widgets.pageRecherche&&"Resultat_Recherche_Tous_Produits"===i.page_name&&n&&c({widgetKey:e.eb.vars.widgets.pageRecherche,outsideTemplate:l.coverflowHeader,trackingParam:"Page recherche"}),e.eb.vars.widgets.panierRecapitulatif&&"Panier Final"===i.page_name){var u=!1,d=null,f=null,p=!1,b=["1-9667431","1-9667432","1-9667433","1-9667434","1-9667435","1-9667436","1-9667439","1-9667440","1-9667437","1-9667438","1-2022505","1-2022513","1-2022507","1-2022509","1-2022514","1-2022515","1-3076378","1-2022522","1-2022516","1-2022517","1-2022518","1-2022506","1-2816995","1-2022508"];i.order_products.forEach(function(e){var t=e[3],r=e[10];b.indexOf(t)<0&&("3"!=t.charAt(0)&&"1"!=t.charAt(0)||(f=e[3]),(!d||d.price<e[5])&&(d={price:e[5],id:e[3]}),"3"==t.charAt(0)&&(u=!0)),r.indexOf("#FORMAT=ePub")>=0&&(p=!0)}),c({widgetKey:e.eb.vars.widgets.panierRecapitulatif,trackingParam:"Panier recap",postLoadWidget:function(){var t=e.eb.$(this.selector);t.find("article[data-product-id] button[data-trackingbannerinfo]").each(function(t,r){e.eb.$(r).attr("data-trackingbannerinfo",e.eb.$(r).attr("data-trackingbannerinfo").replace("S:PFreco|PF|","S:Suggestion|PanierFinal|"))}),t.find("article[data-product-id] a").each(function(t,r){e.eb.$(r).attr("href",e.eb.$(r).attr("href").replace("S:PFreco|PF|","S:Suggestion|PanierFinal|"))}),Fnac.Services.Basket.initBasketCarouselInline()},variables:{$hasMarketplace:u,$mostExpensiveProductId:d?d.id:null,$lastProductId:f,$hasEbook:p},url:"/api/navigation/rest/v1/thumbnail/suggestions/basket"})}})})})}(window);