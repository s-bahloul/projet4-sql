!function(modules){var installedModules={};function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.l=!0,module.exports}__webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.d=function(exports,name,getter){__webpack_require__.o(exports,name)||Object.defineProperty(exports,name,{enumerable:!0,get:getter})},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.t=function(value,mode){if(1&mode&&(value=__webpack_require__(value)),8&mode)return value;if(4&mode&&"object"==typeof value&&value&&value.__esModule)return value;var ns=Object.create(null);if(__webpack_require__.r(ns),Object.defineProperty(ns,"default",{enumerable:!0,value:value}),2&mode&&"string"!=typeof value)for(var key in value)__webpack_require__.d(ns,key,function(key){return value[key]}.bind(null,key));return ns},__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,"a",getter),getter},__webpack_require__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__webpack_require__.p="/",__webpack_require__(__webpack_require__.s=88)}({1:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"extractBatch",(function(){return extractBatch})),__webpack_require__.d(__webpack_exports__,"request",(function(){return request})),__webpack_require__.d(__webpack_exports__,"successResponse",(function(){return successResponse})),__webpack_require__.d(__webpack_exports__,"errorResponse",(function(){return errorResponse})),__webpack_require__.d(__webpack_exports__,"post",(function(){return post})),__webpack_require__.d(__webpack_exports__,"listen",(function(){return listen})),__webpack_require__.d(__webpack_exports__,"postAndForget",(function(){return postAndForget}));var com_batch_shared_logger__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2);const extractBatch=e=>e&&e.data&&e.data.batch?e.data.batch:null,request=(from,msg,args)=>({batch:{kind:"request",from:from,msg:msg,args:args||[]}}),successResponse=(from,msg,result)=>({batch:{kind:"response",from:from,msg:msg,success:!0,result:result}}),errorResponse=(from,msg,error)=>({batch:{kind:"response",error:error?String(error):"Unknown Error",from:from,msg:msg,success:!1}});function post(from,to,msg,args){return new Promise((resolve,reject)=>{const channel=new MessageChannel;channel.port1.onmessage=e=>{const batch=extractBatch(e);batch&&"request"!==batch.kind?batch.success?resolve(batch.result):reject(batch.error):(com_batch_shared_logger__WEBPACK_IMPORTED_MODULE_0__.Log.warn("message","("+from+")","invalid response",e),reject("Invalid response"))},to.postMessage(request(from,msg,args),"*",[channel.port2])})}const listen=(from,listener)=>window.addEventListener("message",e=>{const batch=extractBatch(e);null!=batch&&batch.from===from&&(com_batch_shared_logger__WEBPACK_IMPORTED_MODULE_0__.Log.debug("message","("+from+")","recieved",batch),listener(batch,e))}),postAndForget=(from,to,msg,args)=>to.postMessage(request(from,msg,args),"*")},2:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"LogLevel",(function(){return LogLevel})),__webpack_require__.d(__webpack_exports__,"Log",(function(){return Log}));var com_batch_dom_iframe_channel_message__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_config__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_helpers_window__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(4);let LogLevel;!function(LogLevel){LogLevel[LogLevel.None=0]="None",LogLevel[LogLevel.Public=1]="Public",LogLevel[LogLevel.PublicError=2]="PublicError",LogLevel[LogLevel.Error=3]="Error",LogLevel[LogLevel.Warn=4]="Warn",LogLevel[LogLevel.Info=5]="Info",LogLevel[LogLevel.Trace=6]="Trace",LogLevel[LogLevel.Debug=7]="Debug"}(LogLevel||(LogLevel={}));const instance=new class{constructor(){this.level=LogLevel.PublicError,this.enabledModules=new Set,this.disabledModules=new Set,this.name="SDK",this.enabledModules.add("public"),this.loadStorageSettings(),_config__WEBPACK_IMPORTED_MODULE_1__.IS_DEV&&this.addGlobalEventListeners()}loadStorageSettings(){const safeWindow=Object(_helpers_window__WEBPACK_IMPORTED_MODULE_2__.default)();if(null!=safeWindow&&"object"==typeof safeWindow.localStorage){"1"===safeWindow.localStorage.getItem("com.batch.private.logger.listeners")&&this.addGlobalEventListeners();const rawLevel=safeWindow.localStorage.getItem("com.batch.private.logger.level");if(null!=rawLevel){const level=+rawLevel;level>=0&&level<=6&&(this.level=level)}try{const rawEnabledModules=safeWindow.localStorage.getItem("com.batch.private.logger.modules.enabled");if(rawEnabledModules){const enabledModules=JSON.parse(rawEnabledModules);Array.isArray(enabledModules)&&enabledModules.forEach(m=>{this.enableModule(m)})}const rawDisabledModules=safeWindow.localStorage.getItem("com.batch.private.logger.modules.disabled");if(rawDisabledModules){const disabledModules=JSON.parse(rawDisabledModules);Array.isArray(disabledModules)&&disabledModules.forEach(m=>{this.disableModule(m)})}}catch(_){}}}addGlobalEventListeners(){const safeWindow=Object(_helpers_window__WEBPACK_IMPORTED_MODULE_2__.default)();null!=safeWindow&&(safeWindow.addEventListener("___batchSDK___.logger.enableModule",e=>this.enableModule(e.module)),safeWindow.addEventListener("___batchSDK___.logger.disableModule",e=>this.disableModule(e.module)),safeWindow.addEventListener("___batchSDK___.logger.setLogLevel",e=>{let levelValue;switch(e.level.toLowerCase()){case"none":levelValue=0;break;case"public":levelValue=1;break;case"publicerror":levelValue=2;break;case"error":levelValue=3;break;case"warn":levelValue=4;break;case"info":levelValue=5;break;case"trace":levelValue=6;break;case"debug":default:levelValue=7}this.level=levelValue}))}enableModule(module){this.enabledModules.add(module.toLowerCase())}enableTunneling(to){this.tunnelingTo=to}disableModule(module){this.disabledModules.add(module.toLowerCase())}isModuleEnabled(module){const m=module.toLowerCase();return!this.disabledModules.has(m)&&(this.enabledModules.has("*")||this.enabledModules.has(m))}shouldLogForLevel(wantedLevel){return this.level>0&&wantedLevel<=this.level}logMethodForLevel(wantedLevel){let method;switch(wantedLevel){case LogLevel.Public:method=console.log;break;case LogLevel.PublicError:case LogLevel.Error:method=console.error;break;case LogLevel.Info:method=console.info;break;case LogLevel.Warn:method=console.warn;break;case LogLevel.Trace:method=console.trace;break;case LogLevel.Debug:default:method=console.debug}return method||console.log}getGroupMethod(){return console.group}getGroupEndMethod(){return console.groupEnd}formatPrefix(moduleName){return"public"===moduleName?"Batch":"Batch "+this.name+" ["+moduleName+"]"}public(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];this.log(LogLevel.Public,"public",...args)}publicError(){for(var _len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];this.log(LogLevel.PublicError,"public",...args)}error(module){for(var _len3=arguments.length,args=new Array(_len3>1?_len3-1:0),_key3=1;_key3<_len3;_key3++)args[_key3-1]=arguments[_key3];this.log(LogLevel.Error,module,...args)}warn(module){for(var _len4=arguments.length,args=new Array(_len4>1?_len4-1:0),_key4=1;_key4<_len4;_key4++)args[_key4-1]=arguments[_key4];this.log(LogLevel.Warn,module,...args)}info(module){for(var _len5=arguments.length,args=new Array(_len5>1?_len5-1:0),_key5=1;_key5<_len5;_key5++)args[_key5-1]=arguments[_key5];this.log(LogLevel.Info,module,...args)}trace(module){for(var _len6=arguments.length,args=new Array(_len6>1?_len6-1:0),_key6=1;_key6<_len6;_key6++)args[_key6-1]=arguments[_key6];this.log(LogLevel.Trace,module,...args)}debug(module){for(var _len7=arguments.length,args=new Array(_len7>1?_len7-1:0),_key7=1;_key7<_len7;_key7++)args[_key7-1]=arguments[_key7];this.log(LogLevel.Debug,module,...args)}log(level,moduleName){for(var _len8=arguments.length,args=new Array(_len8>2?_len8-2:0),_key8=2;_key8<_len8;_key8++)args[_key8-2]=arguments[_key8];if(this.tunnelingTo){const a=[];args.forEach(v=>{switch(typeof v){case"number":case"string":case"boolean":a.push(v);break;case"object":try{a.push(v?"["+v.toString()+"]":null)}catch(e){a.push("[No toString method]")}break;default:a.push("[Unsupported type "+typeof v+"]")}}),com_batch_dom_iframe_channel_message__WEBPACK_IMPORTED_MODULE_0__.postAndForget(this.name,this.tunnelingTo,"log",[level,this.name+":"+moduleName,...a])}level!==LogLevel.Public&&level!==LogLevel.PublicError||(moduleName="public"),this.isModuleEnabled(moduleName)&&this.shouldLogForLevel(level)&&this.logMethodForLevel(level).apply(console,[this.formatPrefix(moduleName),"-",...args])}grouped(level,module,groupTitle,lines){if(this.isModuleEnabled(module)&&this.shouldLogForLevel(level)){groupTitle?this.getGroupMethod().apply(console,[this.formatPrefix(module),"-",groupTitle]):this.getGroupMethod().apply(console,[this.formatPrefix(module)]);const logMethod=this.logMethodForLevel(level);lines.forEach(l=>logMethod.apply(console,[l])),this.getGroupEndMethod().apply(console,[])}}},outerSafeWindow=Object(_helpers_window__WEBPACK_IMPORTED_MODULE_2__.default)();null!=outerSafeWindow&&outerSafeWindow.addEventListener("message",e=>{const batch=com_batch_dom_iframe_channel_message__WEBPACK_IMPORTED_MODULE_0__.extractBatch(e);null!=batch&&"request"===batch.kind&&"log"===batch.msg&&batch.args&&instance.log(...batch.args)});const Log=instance},22:function(module,__webpack_exports__,__webpack_require__){"use strict";var LocalSDKEvent;__webpack_require__.r(__webpack_exports__),function(LocalSDKEvent){LocalSDKEvent.All="*",LocalSDKEvent.ProfileChanged="profileChanged",LocalSDKEvent.SubscriptionChanged="subscriptionChanged",LocalSDKEvent.UiComponentReady="uiComponentReady",LocalSDKEvent.UiComponentDrawn="uiComponentDrawn",LocalSDKEvent.UiReady="uiReady",LocalSDKEvent.HashChanged="hashChanged"}(LocalSDKEvent||(LocalSDKEvent={})),__webpack_exports__.default=LocalSDKEvent},3:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"SDK_API_LVL",(function(){return SDK_API_LVL})),__webpack_require__.d(__webpack_exports__,"SDK_VERSION",(function(){return SDK_VERSION})),__webpack_require__.d(__webpack_exports__,"SDK_MAJOR_VERSION",(function(){return SDK_MAJOR_VERSION})),__webpack_require__.d(__webpack_exports__,"SDK_DISMISS_NOTIF_AFTER",(function(){return SDK_DISMISS_NOTIF_AFTER})),__webpack_require__.d(__webpack_exports__,"RETRY_MAX_ATTEMPTS",(function(){return RETRY_MAX_ATTEMPTS})),__webpack_require__.d(__webpack_exports__,"RETRY_MIN_INTERVAL_MS",(function(){return RETRY_MIN_INTERVAL_MS})),__webpack_require__.d(__webpack_exports__,"SSL_SCRIPT_URL",(function(){return SSL_SCRIPT_URL})),__webpack_require__.d(__webpack_exports__,"WS_URL",(function(){return WS_URL})),__webpack_require__.d(__webpack_exports__,"IS_DEV",(function(){return IS_DEV})),__webpack_require__.d(__webpack_exports__,"IS_TEST",(function(){return IS_TEST}));const SDK_API_LVL="1",SDK_VERSION="2.2.2",SDK_MAJOR_VERSION="2",SDK_DISMISS_NOTIF_AFTER=30,RETRY_MAX_ATTEMPTS=3,RETRY_MIN_INTERVAL_MS=1e3,SSL_SCRIPT_URL="via.batch.com",WS_URL="https://ws.batch.com/web",IS_DEV=!1,IS_TEST=!1},33:function(module,__webpack_exports__,__webpack_require__){"use strict";let Permission;__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"Permission",(function(){return Permission})),function(Permission){Permission.Default="default",Permission.Granted="granted",Permission.Denied="denied"}(Permission||(Permission={}))},4:function(module,__webpack_exports__,__webpack_require__){"use strict";function safeGetWindow(){return"object"==typeof window?window:null}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,"default",(function(){return safeGetWindow}))},88:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var com_batch_dom_sdk_impl_sdk__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(33),com_batch_shared_local_sdk_events__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(22),com_batch_shared_logger__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(2);const LSKEY="_batch_ui_native_prompt_dismissed";class NativeRequest{constructor(api,config){this.api=api,this.conf=Object.assign({autoShow:!0,backoffDuration:86400},config)}draw(_){this.api.runsOnOrigin()?this.conf.autoShow&&this.show():com_batch_shared_logger__WEBPACK_IMPORTED_MODULE_2__.Log.public("The 'native' UI component is NOT compatible with Batch SDK's insecure mode.\nPlease make sure you're in a secureenvironment, and that you didn't set 'sameOrigin: false' on the SDK's configuration.")}async show(){let force=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const dismissed=+window.localStorage.getItem(LSKEY),now=Math.round((new Date).getTime()/1e3);if(force||!dismissed||0===this.conf.backoffDuration||now-dismissed>this.conf.backoffDuration){if(!this.api.runsOnOrigin())return void com_batch_shared_logger__WEBPACK_IMPORTED_MODULE_2__.Log.public("Refusing to show the 'native' UI component in insecure mode.\nPlease make sure you're in a secure environment, and that you didn't set 'sameOrigin: false' on the SDK's configuration.");if(Notification.permission===com_batch_dom_sdk_impl_sdk__WEBPACK_IMPORTED_MODULE_0__.Permission.Granted)this.api.subscribe();else if(Notification.permission!==com_batch_dom_sdk_impl_sdk__WEBPACK_IMPORTED_MODULE_0__.Permission.Denied){const permission=await Notification.requestPermission();permission&&(window.localStorage.setItem(LSKEY,Math.round((new Date).getTime()/1e3)+""),permission===com_batch_dom_sdk_impl_sdk__WEBPACK_IMPORTED_MODULE_0__.Permission.Granted&&this.api.subscribe())}}}hide(){}reset(){window.localStorage.removeItem(LSKEY)}}window.batchSDK("ui.register","native",(api,conf,onDrawnCallback)=>{const native=new NativeRequest(api,conf);return api.on(com_batch_shared_local_sdk_events__WEBPACK_IMPORTED_MODULE_1__.default.UiReady,(_,sub)=>{native.draw(sub),onDrawnCallback(native)}),native})}});