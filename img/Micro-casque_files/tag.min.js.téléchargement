/*! Copyright (c) 2022 Mediarithmics; All Rights Reserved */
(()=>{var i={2705:(e,t,i)=>{i=i(5639).Symbol;e.exports=i},6874:e=>{e.exports=function(e,t,i){switch(i.length){case 0:return e.call(t);case 1:return e.call(t,i[0]);case 2:return e.call(t,i[0],i[1]);case 3:return e.call(t,i[0],i[1],i[2])}return e.apply(t,i)}},4636:(e,t,i)=>{var d=i(2545),p=i(5694),l=i(1469),h=i(4144),f=i(5776),g=i(6719),_=Object.prototype.hasOwnProperty;e.exports=function(e,t){var i,n=l(e),o=!n&&p(e),r=!n&&!o&&h(e),s=!n&&!o&&!r&&g(e),a=n||o||r||s,c=a?d(e.length,String):[],u=c.length;for(i in e)!t&&!_.call(e,i)||a&&("length"==i||r&&("offset"==i||"parent"==i)||s&&("buffer"==i||"byteLength"==i||"byteOffset"==i)||f(i,u))||c.push(i);return c}},4865:(e,t,i)=>{var o=i(9465),r=i(7813),s=Object.prototype.hasOwnProperty;e.exports=function(e,t,i){var n=e[t];s.call(e,t)&&r(n,i)&&(void 0!==i||t in e)||o(e,t,i)}},9465:(e,t,i)=>{var n=i(8777);e.exports=function(e,t,i){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:i,writable:!0}):e[t]=i}},4239:(e,t,i)=>{var n=i(2705),o=i(9607),r=i(2333),s=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":(s&&s in Object(e)?o:r)(e)}},9454:(e,t,i)=>{var n=i(4239),o=i(7005);e.exports=function(e){return o(e)&&"[object Arguments]"==n(e)}},8458:(e,t,i)=>{var n=i(3560),o=i(5346),r=i(3218),s=i(346),a=/^\[object .+?Constructor\]$/,c=Function.prototype,i=Object.prototype,c=c.toString,i=i.hasOwnProperty,u=RegExp("^"+c.call(i).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!r(e)||o(e))&&(n(e)?u:a).test(s(e))}},8749:(e,t,i)=>{var n=i(4239),o=i(1780),r=i(7005),s={};s["[object Float32Array]"]=s["[object Float64Array]"]=s["[object Int8Array]"]=s["[object Int16Array]"]=s["[object Int32Array]"]=s["[object Uint8Array]"]=s["[object Uint8ClampedArray]"]=s["[object Uint16Array]"]=s["[object Uint32Array]"]=!0,s["[object Arguments]"]=s["[object Array]"]=s["[object ArrayBuffer]"]=s["[object Boolean]"]=s["[object DataView]"]=s["[object Date]"]=s["[object Error]"]=s["[object Function]"]=s["[object Map]"]=s["[object Number]"]=s["[object Object]"]=s["[object RegExp]"]=s["[object Set]"]=s["[object String]"]=s["[object WeakMap]"]=!1,e.exports=function(e){return r(e)&&o(e.length)&&!!s[n(e)]}},313:(e,t,i)=>{var o=i(3218),r=i(5726),s=i(3498),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!o(e))return s(e);var t,i=r(e),n=[];for(t in e)("constructor"!=t||!i&&a.call(e,t))&&n.push(t);return n}},5976:(e,t,i)=>{var n=i(6557),o=i(5357),r=i(61);e.exports=function(e,t){return r(o(e,t,n),e+"")}},6560:(e,t,i)=>{var n=i(5703),o=i(8777),i=i(6557);e.exports=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:i},2545:e=>{e.exports=function(e,t){for(var i=-1,n=Array(e);++i<e;)n[i]=t(i);return n}},7518:e=>{e.exports=function(t){return function(e){return t(e)}}},8363:(e,t,i)=>{var u=i(4865),d=i(9465);e.exports=function(e,t,i,n){var o=!i;i=i||{};for(var r=-1,s=t.length;++r<s;){var a=t[r],c=n?n(i[a],e[a],a,i,e):void 0;void 0===c&&(c=e[a]),(o?d:u)(i,a,c)}return i}},4429:(e,t,i)=>{i=i(5639)["__core-js_shared__"];e.exports=i},1463:(e,t,i)=>{var n=i(5976),c=i(6612);e.exports=function(a){return n(function(e,t){var i=-1,n=t.length,o=1<n?t[n-1]:void 0,r=2<n?t[2]:void 0,o=3<a.length&&"function"==typeof o?(n--,o):void 0;for(r&&c(t[0],t[1],r)&&(o=n<3?void 0:o,n=1),e=Object(e);++i<n;){var s=t[i];s&&a(e,s,i,o)}return e})}},8777:(e,t,i)=>{var n=i(852),i=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=i},1957:(e,t,i)=>{i="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g;e.exports=i},852:(e,t,i)=>{var n=i(8458),o=i(7801);e.exports=function(e,t){return t=o(e,t),n(t)?t:void 0}},9607:(e,t,i)=>{var n=i(2705),i=Object.prototype,r=i.hasOwnProperty,s=i.toString,a=n?n.toStringTag:void 0;e.exports=function(e){var t=r.call(e,a),i=e[a];try{var n=!(e[a]=void 0)}catch(e){}var o=s.call(e);return n&&(t?e[a]=i:delete e[a]),o}},7801:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},5776:e=>{var n=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var i=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==i||"symbol"!=i&&n.test(e))&&-1<e&&e%1==0&&e<t}},6612:(e,t,i)=>{var o=i(7813),r=i(8612),s=i(5776),a=i(3218);e.exports=function(e,t,i){if(!a(i))return!1;var n=typeof t;return!!("number"==n?r(i)&&s(t,i.length):"string"==n&&t in i)&&o(i[t],e)}},5346:(e,t,i)=>{var i=i(4429),n=(i=/[^.]+$/.exec(i&&i.keys&&i.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"";e.exports=function(e){return!!n&&n in e}},5726:e=>{var i=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||i)}},3498:e=>{e.exports=function(e){var t=[];if(null!=e)for(var i in Object(e))t.push(i);return t}},1167:(e,t,i)=>{e=i.nmd(e);var i=i(1957),t=t&&!t.nodeType&&t,n=t&&e&&!e.nodeType&&e,o=n&&n.exports===t&&i.process,i=function(){try{var e=n&&n.require&&n.require("util").types;return e?e:o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=i},2333:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},5357:(e,t,i)=>{var c=i(6874),u=Math.max;e.exports=function(r,s,a){return s=u(void 0===s?r.length-1:s,0),function(){for(var e=arguments,t=-1,i=u(e.length-s,0),n=Array(i);++t<i;)n[t]=e[s+t];for(var t=-1,o=Array(s+1);++t<s;)o[t]=e[t];return o[s]=a(n),c(r,this,o)}}},5639:(e,t,i)=>{var n=i(1957),i="object"==typeof self&&self&&self.Object===Object&&self,i=n||i||Function("return this")();e.exports=i},61:(e,t,i)=>{var n=i(6560),n=i(1275)(n);e.exports=n},1275:e=>{var r=Date.now;e.exports=function(i){var n=0,o=0;return function(){var e=r(),t=16-(e-o);if(o=e,0<t){if(800<=++n)return arguments[0]}else n=0;return i.apply(void 0,arguments)}}},346:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},3045:(e,t,i)=>{var n=i(8363),o=i(1463),r=i(1704),o=o(function(e,t){n(t,r(t),e)});e.exports=o},5703:e=>{e.exports=function(e){return function(){return e}}},7813:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},2205:(e,t,i)=>{e.exports=i(3045)},6557:e=>{e.exports=function(e){return e}},5694:(e,t,i)=>{var n=i(9454),o=i(7005),i=Object.prototype,r=i.hasOwnProperty,s=i.propertyIsEnumerable,n=n(function(){return arguments}())?n:function(e){return o(e)&&r.call(e,"callee")&&!s.call(e,"callee")};e.exports=n},1469:e=>{var t=Array.isArray;e.exports=t},8612:(e,t,i)=>{var n=i(3560),o=i(1780);e.exports=function(e){return null!=e&&o(e.length)&&!n(e)}},4144:(e,t,i)=>{e=i.nmd(e);var n=i(5639),o=i(5062),i=t&&!t.nodeType&&t,t=i&&e&&!e.nodeType&&e,n=t&&t.exports===i?n.Buffer:void 0,n=n?n.isBuffer:void 0;e.exports=n||o},3560:(e,t,i)=>{var n=i(4239),o=i(3218);e.exports=function(e){return!!o(e)&&("[object Function]"==(e=n(e))||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e)}},1780:e=>{e.exports=function(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=9007199254740991}},3218:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},7005:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},6719:(e,t,i)=>{var n=i(8749),o=i(7518),i=i(1167),i=i&&i.isTypedArray,n=i?o(i):n;e.exports=n},1704:(e,t,i)=>{var n=i(4636),o=i(313),r=i(8612);e.exports=function(e){return r(e)?n(e,!0):o(e)}},5062:e=>{e.exports=function(){return!1}},2707:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o,r,s,a,c,u,d,p=i(5737),l=i(7238),h=i(2461),f=i(971),t=i(2228),n=n(i(3045)),i=window.navigator.userAgent;function g(e){return void 0!==e.context}function _(t){f.mics._names.forEach(function(e){t(e)})}function v(t){_(function(e){e=f.mics[e];g(e)&&t(e)})}/googlebot|bingbot|yandexbot|baiduspider/i.test(i)||(o=!1,r=(new Date).getTime(),t="1"===(0,t.readCookie)("mics_debug_tag")||!1,s=(0,h.Console)("tag",t),new p.AdServer(t).setDFPTargeting(),p={_tagVersion:"2.0.1",_setConfig:function(t){return v(function(e){return e.setConfig(t)})},_setInstallationId:function(t){return v(function(e){return e.setInstallationId(t)})},_declareAdvertisingCookieConsent:function(t){return v(function(e){return e.declareAdvertisingCookieConsent(t)})},_revokeAdvertisingCookieConsent:function(){return v(function(e){return e.revokeAdvertisingCookieConsent()})},_setEvaluator:function(t){return v(function(e){return e.setEvaluator(t)})},_setDeviceInfo:function(t){return v(function(e){return e.setDeviceInfo(t)})},_setSegmentDefinition:function(t){return v(function(e){return e.setSegmentDefinition(t)})},_setOperatorId:function(t,i){return v(function(e){return e.setOperatorId(t,i)})},_setUAID:function(t,i,n){return v(function(e){return e._setUAID(t,i,n)})},_reset:function(e){o&&!e||(o=!0,s.info("mics.reset"),v(function(e){return e._reset()}),a._startTime=r)}},(a=f.mics)._tagVersion||(0,n.default)(a,p),u=t,d=(c=a)._queue,_(function(e){c[e]&&g(c[e])||(c[e]=new l.TagObject(e,u),window[e]=c[e])}),_(function(e){!function(e,t){var i=f.mics[e];for(;t.length;){var n=t.shift();n&&g(i)&&(console.debug("executing ",n,"on",e),i.callMicsMethod(n.method,n.args))}}(e,d[e])}),p={_setConfig:p._setConfig,_setInstallationId:p._setInstallationId,_setSegmentDefinition:p._setSegmentDefinition,_setDeviceInfo:p._setDeviceInfo,_setEvaluator:p._setEvaluator},window.mics=window.mics||{},(0,n.default)(window.mics,p),window.addEventListener&&window.addEventListener("beforeunload",function(){v(function(e){return e.pageQuit()})},!1))},5737:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AdServer=void 0;var n=i(6701),o=i(2461),i=(r.prototype.setDFPTargeting=function(){var i=this;try{window.googletag&&window.googletag.cmd?window.googletag.cmd.push(function(){var e=i.cache.get("mics_sgmts"),e=e&&"string"==typeof e?JSON.parse(e):void 0,t=e||{};Object.keys(t).forEach(function(e){window.googletag.pubads().setTargeting("mics_"+e,t[e].map(String))})}):this.console.info("DFP is not present")}catch(e){this.console.error("error setting DFP",e)}},r);function r(e){this.debug=e,this.cache=new n.Cache(!0),this.console=(0,o.Console)("AdServer",e),this.console.info("Starting Ad Server Connection")}t.AdServer=i},6701:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cache=void 0;var n=i(2461),i=(o.prototype.get=function(e){if(this.canUseLocalStorage)return window.localStorage.getItem(e)||void 0},o.prototype.store=function(e,t){this.canUseLocalStorage&&window.localStorage.setItem(e,t)},o.prototype.remove=function(e){this.canUseLocalStorage&&window.localStorage.removeItem(e)},o.prototype.isLocalStorageEnabled=function(){try{var e="is_enabled";return localStorage.setItem(e,"true"),"true"===localStorage.getItem(e)}catch(e){return this.debug&&console.log("localStorage is not enabled",e),!1}},o);function o(e){this.debug=e,this.console=(0,n.Console)(o.name,e),this.canUseLocalStorage=this.isLocalStorageEnabled()}t.Cache=i},2461:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Console=void 0;var a=i(971);t.Console=function(r,s){return function(e){var t,i={};for(t in e)i[e[t]]=function(o){return function(){if(s&&window.console&&Object.keys(window.console).includes(o))try{var e=Array.prototype.slice.apply(arguments),t=(new Date).getTime(),i=(0,a.durationFromSnippetStart)(t),n=i?i/1e3:0;e.unshift("ctx:"+r+"]"),e.unshift("[mics "+n.toFixed(3)+"s"),window.console[o].apply(window.console,e)}catch(e){window.console.log(e)}}}(e[t]);return i}("log debug info warn error".split(" "))}},2228:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=(t.updateCookiesExpirationStartingWith=t.deleteCookiesStartingWith=t.readCookie=void 0,i(2461).Console)("CookieHelper",!1);function n(e,t){if(e&&t)for(var i=document.cookie.split(";"),n=0;n<i.length;n++){var o=i[n].replace(/ /g,"").split("=");o[0].startsWith(e)&&(r.debug("update cookie",o[0],o[1]),document.cookie=o[0]+"="+o[1]+";path=/;expires="+t)}}t.readCookie=function(e){for(var t=document.cookie.split(";"),i=0;i<t.length;i++){var n=t[i].replace(/ /g,"").split("=");if(n[0]===e)return r.debug("found cookie",n[0],n[1]),n[1]}},t.deleteCookiesStartingWith=function(e){var t=new Date;t.setTime(0),n(e,t.toUTCString())},t.updateCookiesExpirationStartingWith=n},517:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CookieMatcher=void 0;var s=i(2228),a=i(5098),c=i(2461),i=(n.prototype.setOperators=function(e){this.operators=e},n.prototype.setIsTcfEnabled=function(e){this.isTcfEnabled=e},n.prototype.end=function(){return this.gatherIdEnd},n.prototype.panicCallback=function(e){this.panicFn=e},n.prototype.setEtid=function(e){this.etid=e,this.finishIfPossible(!1)},n.prototype.isCookieMatchingAuthorizedByTcfApi=function(){return!this.isTcfEnabled||!!(this.tcfVendorMicsConsent&&this.tcfPurposesConsents||!1===this.gdprApplies)},n.prototype.destroy=function(){window.clearTimeout(this.watchDog)},n);function n(e,t,i,n,o){var r=this;this.gatherOperatorsIds=function(){r.console.info("gatherOperatorsIds",r.operators);for(var e=0;e<r.operators.length;e++)r.gatherId(r.operators[e]);0<r.timeout&&(r.watchDog=window.setTimeout(function(){r._timeout()},r.timeout))},this.gatherId=function(t){var e=r.options.gather_operator_id_url+"?opid="+t;r.isTcfEnabled&&(e=e+"&gdpr="+(!1===r.gdprApplies?"0":"1")),r.tcfstr&&r.isTcfEnabled&&(e=e+"&gdpr_consent="+r.tcfstr),r.options.override_transport&&r.options.override_transport(e),(0,a.loadScript)(e,function(e){e&&(r.console.info("error while gather_id",t),r.setOperatorId(t,null))})},this.setOperatorId=function(e,t){r.isCookieMatchingAuthorizedByTcfApi()&&(t?r.retrievedIds.includes(t)||(r.console.log("setId("+e+", "+t+")"),r.retrievedIds.push(t),r.finished=r.retrievedIds.length===r.operators.length,r.finishIfPossible(!1)):r.finishIfPossible(!1))},this.finishIfPossible=function(e){if(r.console.log("try to finish, panicMode:",e,"etid:",r.etid,"finished",r.retrievedIds.length),r.finished||e){r.gatherIdEnd=(new Date).getTime();for(var t=[];r.retrievedIds.length;){var i=r.retrievedIds.shift();i&&t.push(i)}r.console.log("finishing.");var n=r.options.cookie_matching_url+"?";r.etid&&(n=n+"etid="+r.etid+"&"),r.isTcfEnabled&&(n=n+"gdpr="+(!1===r.gdprApplies?"0":"1")+"&"),r.tcfstr&&(n=n+"gdpr_consent="+r.tcfstr+"&"),r.options.site_token&&(n=n+"$site_token="+r.options.site_token+"&"),r.options.datamart_token&&(n=n+"$dat_token="+r.options.datamart_token+"&");e=r.options.installation_id_namespace&&(0,s.readCookie)(r.options.installation_id_namespace);n=(n=e?n+"$ins="+e+"&":n)+"utidl="+t.join(","),r.options.override_transport&&r.options.override_transport(n),(0,a.loadScript)(n,function(e){e&&r.panicFn&&(r.console.info("failed to load get_id"),r.panicFn("$get_id_failed"))}),r.ran=!0,r.destroy()}},this._timeout=function(){r.isCookieMatchingAuthorizedByTcfApi()?r.finishIfPossible(!0):r.destroy()},this.finished=!1,this.ran=!1,this.operators=[],this.retrievedIds=[],this.timeout=e.global_timeout_ms,this.watchDog=void 0,this.options=e,this.console=(0,c.Console)("CookieMatcher",e.debug),this.tcfstr=o,this.tcfVendorMicsConsent=t,this.tcfPurposesConsents=i,this.gdprApplies=n}t.CookieMatcher=i},4471:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CurrentPage=void 0;var r=i(2228),i=(n.prototype._parseSearch=function(e){for(var t,i,n=e.substring(1).split("&"),o={},r=0;r<n.length;r++)t=(i=n[r].split("="))[0],i=i[1],o[t]=decodeURIComponent(i).replace(/\+/g," ");return o},n.prototype._setReady=function(){this.ready=!0},n.prototype.isReady=function(){return this.ready},n.prototype.readPage=function(){this.properties.$referrer=document.referrer,this.properties.$url=""+document.location;for(var e="utm_source utm_medium utm_term utm_content utm_campaign".split(" "),t=this._parseSearch(window.location.search),i=0;i<e.length;i++){var n=e[i];t[n]&&(this.properties["$"+n]=t[n])}!this.options.local_cookie_name||(o=(0,r.readCookie)(this.options.local_cookie_name))&&(this.properties.raw_cookie=o);var o=(0,r.readCookie)("mics_uaid");o&&(this.properties.$uaid=o);o=(0,r.readCookie)("mics_vid");o&&this.userIdentifierHolder.addUserAgentIdentifier(o);o=this.options.installation_id_namespace&&(0,r.readCookie)(this.options.installation_id_namespace);o&&(this.properties.$ins=o);o=(0,r.readCookie)("mics_lts"),o=o&&parseInt(o,10);o&&!isNaN(o)&&(this.properties.$lts=o),window.__tcfapi&&(o=!(this.properties.$tcfapi=1)===this.gdprApplies?"0":"1",this.properties.$gdpr=o),this.tcfstr&&(this.properties.$gdpr_consent=this.tcfstr)},n.prototype.getVid=function(){return this.userIdentifierHolder.findVectorIdLongValue()},n.prototype.getInstallationid=function(){return this.userIdentifierHolder.findInstallationIdRawValue()},n.prototype.getLts=function(){return this.properties.$lts},n.prototype.getCookie=function(){return this.properties.$uaid},n.prototype.updateUAID=function(e,t){var i=new Date;i.setTime(i.getTime()+24*this.options.cookie_max_age_in_days*60*60*1e3),e&&(this.userIdentifierHolder.addUserAgentIdentifier(e),document.cookie="mics_vid="+encodeURIComponent(e)+";expires="+i.toUTCString()+";path=/"),t&&(this.properties.$lts=t,document.cookie="mics_lts="+encodeURIComponent(t)+";expires="+i.toUTCString()+";path=/"),this._setReady()},n.prototype.updateInstallationId=function(e){var t=new Date;t.setTime(t.getTime()+24*this.options.cookie_max_age_in_days*60*60*1e3),e&&(this.userIdentifierHolder.addUserAgentIdentifier("ins:"+e),document.cookie=this.options.installation_id_namespace+"="+encodeURIComponent(e)+";expires="+t.toUTCString()+";path=/")},n);function n(e,t,i,n){this.properties={},this.options=e,this.ready=!1,this.tcfstr=n,this.gdprApplies=i,this.userIdentifierHolder=t}t.CurrentPage=i},8146:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EventPusher=void 0;var c=i(2461),n=i(5098),s=i(971);function a(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}o.prototype.sendCallQueue=function(e,t){for(var i=this.callQueue,n=t||{};i.length;){var o=(0,s.durationFromSnippetStart)((new Date).getTime());o&&(n.$delay={$push:o,$start:(0,s.durationFromSnippetStart)(this.tagStart),$gather_id_end:(0,s.durationFromSnippetStart)(this.cookieMatcher.end()),$beacon:e===this.beacon});var r=a(r=i.shift()||{},this.currentPage.properties);r=a(r,this.globalProperties),r=a(r,n),r=a(r,this.userIdentifierHolder.getEventPusherProperties()),this.console.info("pushing",r);o=this.endPointUrl+"?"+this.generateHttpQuery(r);this.eventsRunning++,e(o,this.pixelSentCallback(this)),this.userPoint&&this.userPoint.addEvent(r)}this.panicMode||(this.console.info("complete before panicMode, clearing watchDog"),this.clearWatchDog())},o.prototype.clearWatchDog=function(){this.watchDog&&(this.console.log("clearing watchdog"),window.clearTimeout(this.watchDog),this.watchDog=void 0)},o.prototype.setPanicCallback=function(e){this.panicFn=e},o.prototype.triggerCallsIfPossible=function(){var e;this.console.info("trigger calls if possible: currentPage:",this.currentPage,"panicMode:",this.panicMode,", global:",this.globalProperties,"callQueue:",this.callQueue,"userIdentfiers:",this.userIdentifierHolder.userIdentifiers),(this.currentPage&&this.currentPage.isReady()||this.panicMode)&&(e={},this.panicMode&&this.panicReason&&(e.$error=this.panicReason),this.sendCallQueue(this.transportFunction||n.sendWithBeaconOrWithLoadPixel,e))},o.prototype.setUserpoint=function(e){this.userPoint=e},o.prototype.pixelSentCallback=function(i){return function(e,t){if(e?(i.eventsRunning--,i.console.info("error with",e)):(i.console.info("successfully sent",t),i.eventsRunning--),i.finishedCallbackFunction&&0===i.eventsRunning){i.console.info("calling callback function: eventsRunning:",i.eventsRunning,"errors:",i.errorEvents);try{i.finishedCallbackFunction.apply(0===i.errorEvents.length)}catch(e){i.console.error("error has occurred while calling callback function",e)}}}},o.prototype.pushDefault=function(){this.push("$page_view",void 0)},o.prototype.push=function(e,t){if(!this.currentPage)throw new Error("mics is not initialized, call mics.init(YOUR_TOKEN) first !");(t=t||{}).$ev=e,this.callQueue.push(t),this.triggerCallsIfPossible()},o.prototype.addProperties=function(e){this.globalProperties=a(this.globalProperties,e),this.console.info("properties: ",this.globalProperties)},o.prototype.generateHttpQuery=function(e){var t,i=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&"object"!=typeof e[t]?i.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t])):"object"==typeof e[t]&&"object"==typeof JSON&&i.push(encodeURIComponent(t)+"=jso-"+encodeURIComponent(JSON.stringify(e[t])));return i.join("&")},o.prototype.panic=function(e){this.console.info("switching to panic mode ! reason:",e),this.panicMode=!0,this.panicReason=e,this.triggerCallsIfPossible()},o.prototype.onFinish=function(e,t){this.finishedCallbackFunction=e,this.setWatchDog(t)},o.prototype.beacon=function(e){navigator.sendBeacon(e)},o.prototype.pageQuit=function(){for(this.console.log("page is unloading"),this.console.log("send call queue with navigator.beacon ("+this.errorEvents.length+" events)");this.errorEvents.length;)this.beacon(this.errorEvents.shift());0<this.eventsRunning&&this.push("$quit_while_running",void 0),this.sendCallQueue(this.beacon,{$error:"page_quit"})},i=o;function o(e,t,i,n,o,r,s){var a=this;this.callQueue=[],this.setWatchDog=function(e){a.console.info("setup watchdog timer to ",e),a.clearWatchDog(),a.watchDog=setTimeout(function(){a.panic("$count_down_1")},e)},this.context=e,this.console=(0,c.Console)("EventPusher-"+e,r.debug),this.console.info("new EventPusher()"),this.callQueue=[],this.currentPage=i,this.transportFunction=r.overrideTransport,this.cookieMatcher=n,this.userPoint=o,this.tagStart=t,this.globalProperties={},this.eventsRunning=0,this.endPointUrl=r.endPointUrl,this.panicMode=!1,this.errorEvents=[],this.options=r,this.userIdentifierHolder=s}t.EventPusher=i},4836:(e,t,i)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.processExternalFeedsWith=t.processExternalFeeds=void 0;var s=i(5098),o=864e5;function a(e){var i={s:(e=e).s,hc:e.hc,c:e.c,p:e.p||o,st:e.st,dn:e.dn,cb:function(e){if(e&&"function"==typeof e)return e;return function(e,t){}}(e.cb),vid:e.vid,ot:e.ot},n=JSON.parse(i.s.getItem("_mediarithmics")),e=(n=n||{})[i.st];(!e||i.c.now()-e.lastFeedRefreshDate>i.p)&&(e="https://"+i.dn+"/v1/sites/"+i.st+"/external_feeds",i.vid&&(e=e+"?"+encodeURIComponent("$vid")+"="+encodeURIComponent(i.vid)),(i.ot||i.hc.get)(e,function(e,t){e?i.cb(e,null):!function(e){try{var t=JSON.parse(e);return Array.isArray(t.scripts)&&Array.isArray(t.feeds)}catch(e){return!1}}(t)?i.cb(null,t):(t=JSON.parse(t),n[i.st]={lastFeedRefreshDate:i.c.now()},i.s.setItem("_mediarithmics",JSON.stringify(n)),t.scripts.map(function(e){var t;"INLINE"===e.type?((t=document.createElement("script"))[void 0===t.innerText?"textContent":"innerText"]=e.inner,document.head.appendChild(t)):"SRC"===e.type?((t=document.createElement("script")).src=e.source,document.head.appendChild(t)):"IMG"===e.type&&i.hc.loadPixel(e.source,void 0)}),i.cb(null,t.feeds))}))}t.processExternalFeeds=function(e,t,i,n,o,r){a({s:window.localStorage?localStorage:{setItem:function(e,t){return null},getItem:function(e){return null}},hc:{get:s.get,loadPixel:s.loadPixel},c:Date,p:e,st:t,dn:i,cb:n,vid:o,ot:r})},t.processExternalFeedsWith=a},971:function(e,t){"use strict";var i=this&&this.__rest||function(e,t){var i={};for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(i[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(i[o[n]]=e[o[n]]);return i};Object.defineProperty(t,"__esModule",{value:!0}),t.durationFromSnippetStart=t.mics=void 0;var n,o=window.scimhtiraidem;if(!(o=!window.scimhtiraidem&&window.mics&&void 0!==window.mics._snippetVersion?{_queue:{mics:(n=window.mics)._queue},_names:["mics"],_snippetVersion:n._snippetVersion,_startTime:n._startTime,mics:i(n,["_queue","_snippetVersion","_startTime"])}:o))throw new Error("mics is not defined. Did you used the provided snippet ?");var r=o;t.mics=r,window.scimhtiraidem=r,t.durationFromSnippetStart=function(e){return e&&r&&e-r._startTime}},5098:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sendWithBeaconOrWithLoadPixel=t.get=t.loadScript=t.loadPixel=void 0,t.loadPixel=function(t,i){var e=document.createElement("img");e.style.display="none",e.style.width=e.style.height="0px",i&&(e.onload=function(){i(void 0,t)},e.onerror=function(){var e=new Error("error while loading "+t);i(e,t)}),e.setAttribute("src",t)},t.loadScript=function(t,i){var e,n=document.createElement("script");n.setAttribute("type","text/javascript"),n.setAttribute("src",t),n.setAttribute("async","true"),i&&(n.onload=function(){i(void 0,t)},n.onerror=function(){var e=new Error("error while loading"+t);i(e,void 0)}),null!==(e=document.getElementsByTagName("script")[0].parentNode)&&void 0!==e&&e.appendChild(n)},t.get=function(t,i){var n=new XMLHttpRequest;n.onreadystatechange=function(){var e;4===n.readyState&&(200===n.status?i(void 0,n.responseText):(e=new Error("error while GETting: "+t),i(e,void 0)))},n.open("GET",t,!0),n.withCredentials=!0,n.send(null)},t.sendWithBeaconOrWithLoadPixel=function(e,t){if(!navigator.sendBeacon)return this.loadPixel(e,t);t(navigator.sendBeacon(e)?void 0:new Error("Error while calling "+e+"with sendBeacon()"),e)}},7238:function(e,t,i){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TagObject=void 0;var o=i(6701),r=i(517),s=i(2461),a=i(4471),c=i(5098),u=i(8146),d=i(4836),p=i(971),l=i(8713),h=i(2228),f=n(i(2205)),g=n(i(1216));function _(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}var i="https://cookie-matching.mediarithmics.com",v="mics_user_consent",m="mics_consent_ts",y=(new Date).getTime(),b={domain_id:1,cookie_matching_url:i+"/v1/getids",gather_operator_id_url:i+"/v1/gather_id",get_id_path:"/v1/get_id",domain_name:"events.mediarithmics.com",protocol:"https://",events_path:"/v1/visits/pixel",config_server_path:"/v1/conf.js",cookie_max_age_in_days:365,cookie_refresh_in_days:10,local_cookie_name:void 0,gather_id_timeout_ms:2e3,global_timeout_ms:3e3,debug:!1},I={xandr:32,mediarithmics:184,google:755},i=(P.prototype.fetchConfig=function(){var e="";this.options.site_token?(this.options=_(this.options,{installation_id_namespace:"mics_"+this.options.site_token}),e="?$site_token="+this.options.site_token+"&cb="+Date.now()):this.options.datamart_token&&(e="?$dat_token="+this.options.datamart_token+"&cb="+Date.now());e=this.options.protocol+this.options.domain_name+this.options.config_server_path+e;this.options.js_mock_params&&(e=e+"&"+this.options.js_mock_params),(0,c.loadScript)(e)},P.prototype.fetchScriptFromUri=function(e){(0,c.loadScript)(this.options.protocol+this.options.domain_name+e)},P.prototype.fetchScriptFromUrl=function(e){(0,c.loadScript)(e)},P.prototype.addPixel=function(e){e=this.options.protocol+this.options.domain_name+e;this.console.debug("Will load pixelUrl "+e),this.options.override_transport?this.options.override_transport(e):(0,c.loadPixel)(e)},P.prototype.call=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var n=Array.prototype.slice.apply(t).splice(0);this.callMicsMethod(e,n)},P.prototype.callMicsMethod=function(e,t){["init","call","config","push","pushDefault","addIdentifier","addProperties","addProperty","onFinish","onStart","_reset","syncFeeds"].includes(e)?this[e].apply(this,t):this.console.error("The method '"+e+"' is not supported.")},P.prototype.onStart=function(e){e&&e.apply()},P.prototype.setOperatorId=function(e,t){this.cookieMatcher&&this.cookieMatcher.setOperatorId(e,t)},P.prototype.getParamOrElse=function(e,t,i){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:i},P.prototype.clearWatchDog=function(){this.eventPusher&&this.eventPusher.clearWatchDog()},P.prototype.setConfig=function(e){var i=this;this.currentPage&&(this.console.info("setConfig",e),e.audience_feeds_refresh_period&&this.addProperties({$audience_feeds_refresh_period:e.audience_feeds_refresh_period}),this.enable_local_segment_evaluation=this.getParamOrElse(e,"enable_local_segment_evaluation",!1),this.namespace=e.namespace||"",this.segment_evaluator_uri=e.segment_evaluator_uri||"",this.segment_evaluator_url=e.segment_evaluator_url||"",this.segment_definition_url=e.segment_definition_url||"",this.segment_definition_uri=e.segment_definition_uri||"",this.user_agent_info=e.user_agent_info||{},this.enableGOOMatching=this.getParamOrElse(e,"enable_goo_matching",!0),this.enableAPXMatching=this.getParamOrElse(e,"enable_apx_matching",!0),this.enableTcfForCookieMatching=this.getParamOrElse(e,"enable_tcf_v2_for_cookie_matching",!1),this.cookieMatcher&&this.cookieMatcher.setIsTcfEnabled(this.enableTcfForCookieMatching||!1),this.fetchUAID(this.currentPage.getCookie(),this.currentPage.getVid(),this.currentPage.getLts()),this.enable_local_segment_evaluation&&(this.userpoint=new l.UserPoint(function(e,t){i.addPixel("/v1/edge/pixel?%24site_token="+i.options.site_token+"&%24seg_id="+e+"&%24o=a&%24vid="+encodeURIComponent(t))},function(e,t){i.addPixel("/v1/edge/pixel?%24site_token="+i.options.site_token+"&%24seg_id="+e+"&%24o=d&%24vid="+encodeURIComponent(t))},function(){i.enable_local_segment_evaluation&&i.userpoint&&i.computeSegments()},this.options.debug,this.namespace),this.eventPusher&&this.eventPusher.setUserpoint(this.userpoint),e=this.userIdentifierHolder.findVectorIdLongValue(),this.console.info("vector id",e),this.fetchScriptFromUri("/v1/device_info.js"),e&&this.userpoint.setAgent(e,this.user_agent_info),this.segment_evaluator_uri?this.fetchScriptFromUri(this.segment_evaluator_uri):this.segment_evaluator_url&&this.fetchScriptFromUrl(this.segment_evaluator_url),this.segment_definition_uri?this.fetchScriptFromUri(this.segment_definition_uri):this.segment_definition_url&&this.fetchScriptFromUrl(this.segment_definition_url)),this.eventPusher&&this.eventPusher.triggerCallsIfPossible())},P.prototype.setEvaluator=function(e){this.console.info("Setting Segment Evaluator"),"function"==typeof e&&(this.segment_evaluator=e),this.computeSegments()},P.prototype.setSegmentDefinition=function(e){this.console.info("Setting Segment Definition"),this.segment_definition=e.map,this.computeSegments()},P.prototype.setDeviceInfo=function(e){this.console.info("Setting Device Info"),this.device_info=e,this.userpoint&&this.userpoint.setAgent&&(this.userpoint.setAgent(this.userIdentifierHolder.findVectorIdLongValue(),this.device_info),this.computeSegments())},P.prototype.getConsentDate=function(e){var t=new Date,i=new Date(e),e=i.getTime();return 0<e&&e<t.getTime()?i:t},P.prototype.declareAdvertisingCookieConsent=function(e){var t=this.getConsentDate(e);this.cache.store(v,"true"),this.cache.store(m,t.getTime().toString());e=new Date;e.setTime(t.getTime()+31536e6),(0,h.updateCookiesExpirationStartingWith)("mics_",e.toUTCString())},P.prototype.revokeAdvertisingCookieConsent=function(){this.cache.store(v,"false"),this.cache.remove(m),(0,h.deleteCookiesStartingWith)("mics_")},P.prototype._setUAID=function(e,t,i){this.currentPage&&(t&&!this.set&&(this.set=!0,this.userIdentifierHolder.addUserAgentIdentifier(t),this.console.log("_setUAID(",t,i,")",this.userpoint),this.currentPage.updateUAID(t,i),this.enable_local_segment_evaluation&&this.userpoint&&this.user_agent_info&&this.userpoint.setAgent(t,this.user_agent_info)),this.eventPusher&&this.eventPusher.triggerCallsIfPossible(),this.syncFeedsCb&&(this.syncFeedsCb(),this.syncFeedsCb=void 0))},P.prototype.setInstallationId=function(e){var t;this.console.log("setInstalationId("+e+")"),this.currentPage&&((t=this.currentPage.getInstallationid())?this.currentPage.updateInstallationId(t):this.currentPage.updateInstallationId(e))},P.prototype.hasPurposesConsents=function(e){return!!(e&&0<Object.keys(e).length&&Object.prototype.hasOwnProperty.call(e,"1")&&Object.prototype.hasOwnProperty.call(e,"3"))&&(e[1]&&e[3])},P.prototype.getVendorConsent=function(e,t){return!!(e&&0<Object.keys(e).length&&void 0!==e[t])&&e[t]},P.prototype.init=function(e){var i=this,t=this.initializeTagOptions(e);this.console.info("mcsObj.config, new configuration is",t),this.options=t,window.__tcfapi&&window.__tcfapi("getTCData",2,function(e,t){t&&(i.tcfstr=e.tcString,i.gdprApplies=e.gdprApplies,e.purpose&&e.purpose.consents&&(i.tcfPurposesConsents=i.hasPurposesConsents(e.purpose.consents)),e.vendor&&e.vendor.consents&&(i.tcfVendorGoogleConsent=i.getVendorConsent(e.vendor.consents,i.vendorIds.google),i.tcfVendorXandrConsent=i.getVendorConsent(e.vendor.consents,i.vendorIds.xandr),i.tcfVendorMicsConsent=i.getVendorConsent(e.vendor.consents,i.vendorIds.mediarithmics)))});var n=null,e=null;if("VISIT"===t.mode)n="/v1/visits/pixel",e=this.globalProperties.$site_token=t.site_token;else{if("TOUCH"!==t.mode)throw new Error(this.context+".init : invalid mode ("+t.mode+")");n="/v1/touches/pixel",e=this.globalProperties.$dat_token=t.datamart_token}if(void 0===this.eventPusher){if("string"!=typeof e)throw new Error(this.context+".init : the token must be a string");if(0===e.length)throw new Error(this.context+".init : the token must be a non-empty string");this.currentPage=new a.CurrentPage(t,this.userIdentifierHolder,this.gdprApplies,this.tcfstr),this.fetchConfig(),this.cookieMatcher=new r.CookieMatcher(t,this.tcfVendorMicsConsent,this.tcfPurposesConsents,this.gdprApplies,this.tcfstr),this.currentPage.readPage();n={endPointUrl:t.protocol+t.domain_name+n,debug:t.debug,overrideTransport:t.override_transport};this.eventPusher=new u.EventPusher(this.context,y,this.currentPage,this.cookieMatcher,this.userpoint,n,this.userIdentifierHolder),this.eventPusher.addProperties(this.globalProperties),this.eventPusher.setWatchDog(t.global_timeout_ms),this.cookieMatcher.panicCallback(this.eventPusher.panic.bind(this.eventPusher)),this.addProperty("$tv","2.0.1")}else this.console.warn(this.context+" was already initialized, stop initialization")},P.prototype.pageQuit=function(){this.eventPusher&&this.eventPusher.pageQuit()},P.prototype.onFinish=function(e,t){this.eventPusher&&this.eventPusher.onFinish(e,t)},P.prototype.pushDefault=function(){this.push("$page_view")},P.prototype.push=function(e,t){if(!this.eventPusher)throw new Error(this.context+" is not initialized, call "+this.context+".init(YOUR_TOKEN) first !");this.eventPusher.push(e,t)},P.prototype.addProperty=function(e,t){var i;this.console.debug("addProperty",e,t),"$user_account_id"===e?this.userIdentifierHolder.legacyUserAccountId=t:"$comp_token"===e?this.userIdentifierHolder.legacyCompartmentToken=t:"$email_hash"===e?this.userIdentifierHolder.legacyEmailHash=t:"$email"===e?this.userIdentifierHolder.legacyEmail=t:this.addProperties(((i={})[e]=t,i))},P.prototype.addProperties=function(e){this.console.debug("addProperties",e),this.eventPusher?this.eventPusher.addProperties(e):this.globalProperties=(0,f.default)(this.globalProperties,e)},P.prototype.addIdentifier=function(e,t){this.console.debug("addIdentifier("+e+", "+JSON.stringify(t)+")");try{if("USER_ACCOUNT"!=e&&"USER_EMAIL"!=e)throw new Error("Unsupported identifier type "+e+', valid types are "USER_ACCOUNT" and "USER_EMAIL"');var i=null!==t&&"string"==typeof t?t:JSON.stringify(t);this.userIdentifierHolder.legacyMode=!1,this.userIdentifierHolder.addIdentifierUnsafe(e,i)}catch(e){this.console.error(e)}},Object.defineProperty(P.prototype,"vid",{get:function(){return this.userIdentifierHolder.findVectorIdLongValue()},enumerable:!1,configurable:!0}),P.prototype._reset=function(){this.console.info("reset ",this.context),this.userpoint&&this.userpoint.reset(),this.set=!1,this.options=(0,f.default)({debug:this.options.debug},b),this.globalProperties={$sv:p.mics._snippetVersion},this.cookieMatcher=void 0,this.eventPusher=void 0,this.currentPage=void 0,this.userpoint=void 0,this.userIdentifierHolder.reset(),this.tcfVendorXandrConsent=void 0,this.tcfVendorGoogleConsent=void 0,this.tcfVendorMicsConsent=void 0,this.tcfPurposesConsents=void 0,this.enableGOOMatching=void 0,(this.enableAPXMatching=void 0,h.deleteCookiesStartingWith)("mics_")},P.prototype.config=function(e){return this.options=(0,f.default)(this.options,e=e||{}),e.cookie_matching_url?this.console.info("overriding cookie_matching_url with ",e.cookie_matching_url):e.domain_name&&(this.options.cookie_matching_url=this.options.protocol+this.options.domain_name+this.options.get_id_path,this.console.info("using custom domain, cookie_matching_url will be ",this.options.cookie_matching_url)),this.console.info("mcsObj.config, new configuration is",this.options),this.options},P.prototype.syncFeeds=function(e){function t(){return(0,d.processExternalFeeds)(i.globalProperties.$audience_feeds_refresh_period,i.options.site_token,i.options.domain_name,e,i.userIdentifierHolder.findVectorIdLongValue(),i.options.override_transport||void 0)}var i=this;this.userIdentifierHolder.findVectorIdLongValue()?t():this.syncFeedsCb=t},P);function P(e,t){var a=this;this.fetchUAID=function(e,t,i){var n,o=new Date;o.setTime(o.getTime()-24*a.options.cookie_refresh_in_days*60*60*1e3);var r=[];!0===a.enableGOOMatching&&(!1===a.enableTcfForCookieMatching||!0===a.tcfVendorGoogleConsent&&!0===a.tcfVendorMicsConsent||!1===a.gdprApplies)&&r.push("goo"),!0===a.enableAPXMatching&&(!1===a.enableTcfForCookieMatching||!0===a.tcfVendorXandrConsent&&!0===a.tcfVendorMicsConsent||!1===a.gdprApplies)&&r.push("apx"),a.cookieMatcher&&a.cookieMatcher.setOperators(r),a.enable_local_segment_evaluation&&a.userpoint&&a.userpoint.getAgent&&(n=null===(n=a.userpoint)||void 0===n?void 0:n.getAgent()),t&&i&&(i>o.getTime()||n)?setTimeout(function(){a._setUAID(e,t,i)},0):a.cookieMatcher&&a.cookieMatcher.gatherOperatorsIds()},this.computeSegments=function(){var e,t,i,n,o,r,s=[];a.segment_definition&&a.segment_evaluator&&(t=null===(e=a.userpoint)||void 0===e?void 0:e.getUserPointData(),i=Object.keys(a.segment_definition),n=0,o=10,(r=function(){var e=n+o;i.slice(n,n+o).forEach(function(e){t&&a.segment_evaluator&&a.segment_evaluator(t,a.segment_definition[e])&&s.push(e)}),e<i.length?(n=e,setTimeout(r,100)):(a.console.info("Finished Computing Segments",s),a.userpoint&&a.userpoint.setSegments(s))})())},this.initializeTagOptions=function(e){if(void 0===e)throw new Error(a.context+".init : use a token string or an object");if("string"==typeof e)return _(a.options,{mode:"VISIT",site_token:e,domain_name:a.options.domain_name});var t=_(a.options,e);return e.cookie_matching_url?a.console.info("overriding cookie_matching_url with ",t.cookie_matching_url):t.domain_name&&(t.cookie_matching_url=t.protocol+t.domain_name+t.get_id_path,a.console.info("using custom domain, cookie_matching_url will be ",t.cookie_matching_url)),t},this.context=e,this.namespace="",this.debug=t,this.console=(0,s.Console)(e,t),this.cache=new o.Cache(t),this.user_agent_info={},this.enable_local_segment_evaluation=!1,this.vendorIds=I,this.context=e,this.options=(0,f.default)(b,{debug:t}),this.globalProperties={$sv:p.mics._snippetVersion},this.get=c.get,this.processExternalFeeds=d.processExternalFeeds,this.processExternalFeedsWith=d.processExternalFeedsWith,this.userIdentifierHolder=new g.default(this.console),this.syncFeedsCb=void 0,this.console.info("Creating tag object, globalProperties: "+JSON.stringify(this.globalProperties))}t.TagObject=i},1216:function(e,t){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var n=["vec","ins","tech","web","etag","mob"];function r(i){return function(e){try{var t=JSON.parse(e);return i(t)?{parsed:t,hasError:!1}:{hasError:!0}}catch(e){return{hasError:!0,error:e}}}}function s(e){return null!==e&&"object"==typeof e&&("string"==typeof e.$user_account_id&&(!e.$compartment_token||"string"==typeof e.$compartment_token))}function a(e){return null!==e&&"object"==typeof e&&("string"==typeof e.$email_hash&&(!e.$email||"string"==typeof e.$email))}function c(e){return null!==e&&"object"==typeof e&&"string"==typeof e.$user_agent_id}var o=(u.prototype.reset=function(){this._userIdentifiers=[],this.legacyUserAccountId=void 0,this.legacyCompartmentToken=void 0,this.legacyEmailHash=void 0,this.legacyEmail=void 0,this.legacyMode=!0,this.console.info("Reset user identifiers")},Object.defineProperty(u.prototype,"userIdentifiers",{get:function(){return this.legacyUserAccountId&&(this.legacyCompartmentToken?this.addUserAccountIdentifier(this.legacyUserAccountId,this.legacyCompartmentToken):this.addUserAccountIdentifier(this.legacyUserAccountId)),this.legacyEmailHash&&this.addUserEmailIdentifier(this.legacyEmailHash,this.legacyEmail),this._userIdentifiers},enumerable:!1,configurable:!0}),u.prototype.getEventPusherProperties=function(){if(this.legacyMode){var e={},t=this.findVectorIdLongValue(),i=this.findInstallationIdRawValue();return t&&(e.$vid=t),i&&(e.$ins=i),this.legacyUserAccountId&&(e.$cuid=this.legacyUserAccountId),this.legacyCompartmentToken&&(e.$comp_token=this.legacyCompartmentToken),this.legacyEmailHash&&(e.$email_hash=this.legacyEmailHash),this.legacyEmail&&(e.$email=this.legacyEmail),e}return{$uids:this.toQueryObject()}},u.prototype.toQueryObject=function(){return this.userIdentifiers.map(function(e){switch(e.$type){case"USER_ACCOUNT":return{$tpe:"AC",$acid:e.$user_account_id,$ctok:e.$compartment_token};case"USER_EMAIL":return{$tpe:"EM",$eh:e.$email_hash,$e:e.$email};case"USER_AGENT":return{$tpe:"AG",$agid:e.$user_agent_id};default:return{$tpe:"NA"}}})},u.prototype.addUserAccountIdentifier=function(e,t){this.addIdentifier({$type:"USER_ACCOUNT",$user_account_id:e,$compartment_token:t})},u.prototype.addUserEmailIdentifier=function(e,t){this.addIdentifier({$type:"USER_EMAIL",$email_hash:e,$email:t})},u.prototype.parseUserAgentId=function(e){if(null!==e&&"string"==typeof e){var t={$type:"USER_AGENT"};return new RegExp(/^\d+$/).test(e)?i(i({},t),{$user_agent_id:"vec:"+e}):n.includes(e.split(":")[0])?i(i({},t),{$user_agent_id:e}):void this.console.error("Unknown user agent id "+e)}},u.prototype.addUserAgentIdentifier=function(e){this.console.debug("addUserAgentIdentifier("+e+")");e=this.parseUserAgentId(e);e&&this.addIdentifier(e)},u.prototype.findVectorIdStringValue=function(){var e=this._userIdentifiers.find(function(e){return"USER_AGENT"===e.$type&&e.$user_agent_id.startsWith("vec:")});return e&&e.$user_agent_id},u.prototype.findVectorIdLongValue=function(){var e=this.findVectorIdStringValue();return e&&e.split(":")[1]},u.prototype.findInstallationId=function(){var e=this._userIdentifiers.find(function(e){return"USER_AGENT"===e.$type&&e.$user_agent_id.startsWith("ins:")});return e&&e.$user_agent_id},u.prototype.findInstallationIdRawValue=function(){var e=this.findInstallationId();return e&&e.split(":")[1]},u.prototype.addIdentifier=function(t){var e=!1;switch(t.$type){case"USER_AGENT":e=!!this._userIdentifiers.find(function(e){return"USER_AGENT"===e.$type&&e.$user_agent_id===t.$user_agent_id});break;case"USER_ACCOUNT":e=!!this._userIdentifiers.find(function(e){return"USER_ACCOUNT"===e.$type&&e.$user_account_id===t.$user_account_id&&e.$compartment_token===t.$compartment_token});break;case"USER_EMAIL":e=!!this._userIdentifiers.find(function(e){return"USER_EMAIL"===e.$type&&e.$email_hash===t.$email_hash})}e||(this._userIdentifiers.push(t),this.console.log("New identifier "+JSON.stringify(t)+" added to user_identifiers "+JSON.stringify(this._userIdentifiers)))},u.prototype.addIdentifierUnsafe=function(e,t){this.console.debug("addIdentifierUnsafe("+e+", "+t+")");try{switch(e){case"USER_ACCOUNT":var i=r(s)(t);i.hasError?this.console.error("USER_ACCOUNT identifier invalid: "+t):this.addUserAccountIdentifier(i.parsed.$user_account_id,i.parsed.$compartment_token);break;case"USER_EMAIL":var n=r(a)(t);n.hasError?this.console.error("USER_EMAIL identifier invalid: "+t):this.addUserEmailIdentifier(n.parsed.$email_hash,n.parsed.$email);break;case"USER_AGENT":var o=r(c)(t);o.hasError?this.console.error("USER_AGENT identifier invalid: "+t):this.addUserAgentIdentifier(o.parsed.$user_agent_id);break;default:this.console.warn("Unhandled identifier type "+e)}}catch(e){this.console.error("An unexpected error occured while calling addIdentifierUnsafe: "+e)}},u);function u(e){this._userIdentifiers=[],this.legacyMode=!0,this.console=e}t.default=o},8713:function(e,a,t){"use strict";var c=this&&this.__assign||function(){return(c=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(a,"__esModule",{value:!0}),a.UserPoint=a.MAX_EVENTS_FOR_USER_POINT=a.BASE_SEGMENTS_STORAGE_KEY=a.BASE_USERPOINT_STORAGE_KEY=void 0;var u=t(6701),d=t(2461);a.BASE_USERPOINT_STORAGE_KEY="_mics_up",a.BASE_SEGMENTS_STORAGE_KEY="mics_sgmts",a.MAX_EVENTS_FOR_USER_POINT=200;var p={profiles:[],segments:[],activities:[],events:[],emails:[],agents:[]},t=(i.prototype.reset=function(){this.userPointData=p,this.cache.remove(this.namespace+a.BASE_USERPOINT_STORAGE_KEY),this.cache.remove(a.BASE_SEGMENTS_STORAGE_KEY)},i.prototype.getUserPointData=function(){return this.userPointData},i.prototype.saveUserpoint=function(){var e=this.encrypt(this.userPointData);this.cache.store(this.namespace+a.BASE_USERPOINT_STORAGE_KEY,e);var t=this.cache.get(a.BASE_SEGMENTS_STORAGE_KEY),e=this.getSegmentIds()?this.getSegmentIds():[];t&&"object"==typeof t?t[this.namespace]=e:(t={})[this.namespace]=e,this.cache.store(a.BASE_SEGMENTS_STORAGE_KEY,JSON.stringify(t)),this.console.info("Saving UserPoint",this.userPointData)},i.prototype.setAgent=function(e,t){this.console.debug("setAgent("+e+","+JSON.stringify(t)+")");var i=e,n=t;t&&t!=={}||(n=this.getUserAgentInfo()),(i=!e||""===e?this.getAgent():i)&&n&&(n={id:"vec:"+e,creation_date:Date.now(),creation_ts:Date.now(),user_agent_info:n},this.userPointData.agents=[n],this.saveUserpoint())},i.prototype.getUserAgentInfo=function(){return this.userPointData.agents&&this.userPointData.agents.length&&this.userPointData.agents[0].user_agent_info&&(void 0!==this.userPointData.agents[0].user_agent_info||this.userPointData.agents[0].user_agent_info!=={})?this.userPointData.agents[0].user_agent_info:void 0},i.prototype.getAgent=function(){var e=this.userPointData.agents||[];if(e.length&&e[0].id){e=e[0].id.split(":");return e[e.length-1]}},i.prototype.getVectorId=function(){return this.userPointData.agents&&this.userPointData.agents.length?this.userPointData.agents[0].id:null},i.prototype.getSegmentIds=function(){return this.userPointData.segments.map(function(e){return e.id}).map(String)},i.prototype.formatEvent=function(e){return e.name=e.$ev,e.referrer=e.$referrer,e.date=Date.now(),e.url=e.$url,e.site_token=e.$site_token,delete e.$web_domain_token,delete e.$web_domain_id,delete e.$etag_id,delete e.$vector_last_seen,delete e.$tag_version,delete e.$delay,delete e.$error,delete e.$snippet_version,delete e.$check_cookie_drop_param,delete e.$consent_from_tcf_api,delete e.$gdpr_consent,delete e.$gdpr_applies,delete e.$installation_id,Object.assign(e,e.properties)},i.prototype.encrypt=function(e){return JSON.stringify(e)},i.prototype.decrypt=function(e){return JSON.parse(e)},i);function i(e,t,i,n,o){var s=this;this.userPointData=c({},p),this.setSegments=function(e){s.console.debug("setSegments("+JSON.stringify(e)+")");var i,n=s.getSegmentIds(),o=e.filter(function(t){return!n.find(function(e){return t===e})}),r=n.filter(function(t){return!e.find(function(e){return t===e})});0!==o.length||0!==r.length?(s.userPointData.segments=e.map(function(e){return{id:e,creation_ts:Date.now(),last_modified_ts:Date.now(),expiration_ts:null}}),s.console.info("New Segments",o,"Removed Segments",r,"segments",e),s.saveUserpoint(),(i=function(e){var t=s.getVectorId();t?(s.console.log("found vectorId: "+t),s.onAddition&&o.forEach(function(e){s.onAddition(e,t)}),s.onDeletion&&r.forEach(function(e){s.onDeletion(e,t)})):0<e&&(s.console.log("could not find vectorId. retries left: "+e),setTimeout(i,1e3,e-1))})(5)):s.console.log("No new addition nor deletion, skipping...")},this.addEvent=function(e){s.console.debug("addEvent("+JSON.stringify(e)+")");e=s.formatEvent(e);s.userPointData.events.unshift(e),s.userPointData.events=s.userPointData.events.slice(0,a.MAX_EVENTS_FOR_USER_POINT),s.saveUserpoint(),s.onEvent()},this.namespace=o,this.onAddition=e,this.onDeletion=t,this.onEvent=i,this.console=(0,d.Console)("UserPoint",n),this.cache=new u.Cache(n),this.console.info("Starting UserPoint System");n=this.cache.get(this.namespace+a.BASE_USERPOINT_STORAGE_KEY);if(n)try{var r=this.decrypt(n);this.console.debug("Existing user point found in localStorage : "+JSON.stringify(r)),this.userPointData=r}catch(e){this.console.error("Failed to parse userpoint data in localStorage")}}a.UserPoint=t}},n={};function o(e){var t=n[e];if(void 0!==t)return t.exports;t=n[e]={id:e,loaded:!1,exports:{}};return i[e].call(t.exports,t,t.exports,o),t.loaded=!0,t.exports}o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);o(2707)})();